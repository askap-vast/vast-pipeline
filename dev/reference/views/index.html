<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="VAST Pipeline platform to enable processing of astronomical sources extracted from the ASKAP telescope for radio transient detection science"><meta name=author content="VAST Development Team"><link href=https://vast-survey.org/vast-pipeline/dev/reference/views/ rel=canonical><link rel=icon href=../../img/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.2.1"><title>views.py - VAST Pipeline</title><link rel=stylesheet href=../../assets/stylesheets/main.e8d9bf0c.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=stylesheet href=../../css/lightgallery.min.css><script src=../../js/lightgallery.min.js></script><script src=../../js/lg-zoom.js></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../theme/css/extra.css><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="VAST Pipeline - views.py"><meta property=og:description content="VAST Pipeline platform to enable processing of astronomical sources extracted from the ASKAP telescope for radio transient detection science"><meta content=https://vast-survey.org/vast-pipeline/dev/reference/views/ property=og:url></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#vast_pipeline.views class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <style>
      .md-banner a,
      .md-banner a:focus,
      .md-banner a:hover{color:currentColor}.md-banner
      strong{white-space:nowrap}.md-banner}
  </style> <a href=../../changelog/ > <strong> New in version 1.0.0</strong>: Documentation, add epoch mode and more ðŸ™Œ. Check the <strong>release notes! </strong> </a> </div> </aside> </div> <div data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're viewing an outdated or development version. <a href=../..> <strong>Click here to go to latest stable release.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="VAST Pipeline" class="md-header__button md-logo" aria-label="VAST Pipeline" data-md-component=logo> <img src=../../img/vast-logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> VAST Pipeline </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> views.py </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary data-md-color-accent=blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/askap-vast/vast-pipeline/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> askap-vast/vast-pipeline </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../gettingstarted/installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../using/requireddata/ class=md-tabs__link> Using the Pipeline </a> </li> <li class=md-tabs__item> <a href=../../design/overview/ class=md-tabs__link> Features & Design </a> </li> <li class=md-tabs__item> <a href=../../developing/intro/ class=md-tabs__link> Contributing and Developing </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> FAQ </a> </li> <li class=md-tabs__item> <a href=../../help_and_acknowledgements/ class=md-tabs__link> Help and Acknowledgements </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class="md-tabs__link md-tabs__link--active"> Reference </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="VAST Pipeline" class="md-nav__button md-logo" aria-label="VAST Pipeline" data-md-component=logo> <img src=../../img/vast-logo.png alt=logo> </a> VAST Pipeline </label> <div class=md-nav__source> <a href=https://github.com/askap-vast/vast-pipeline/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> askap-vast/vast-pipeline </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gettingstarted/installation/ class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../../gettingstarted/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../gettingstarted/deployment/ class=md-nav__link> Deployment </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Using the Pipeline <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Using the Pipeline" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Using the Pipeline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/requireddata/ class=md-nav__link> Required Data </a> </li> <li class=md-nav__item> <a href=../../using/access/ class=md-nav__link> Accessing the Pipeline </a> </li> <li class=md-nav__item> <a href=../../using/initrun/ class=md-nav__link> Initialising a Run </a> </li> <li class=md-nav__item> <a href=../../using/runconfig/ class=md-nav__link> Run Configuration </a> </li> <li class=md-nav__item> <a href=../../using/processrun/ class=md-nav__link> Processing a Run </a> </li> <li class=md-nav__item> <a href=../../using/addtorun/ class=md-nav__link> Adding Images to a Run </a> </li> <li class=md-nav__item> <a href=../../using/restorerun/ class=md-nav__link> Restoring a Run </a> </li> <li class=md-nav__item> <a href=../../using/deleterun/ class=md-nav__link> Deleting a Run </a> </li> <li class=md-nav__item> <a href=../../using/genarrow/ class=md-nav__link> Generating Arrow Files </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Exploring the Pipeline Website <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Exploring the Pipeline Website" data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Exploring the Pipeline Website </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../exploringwebsite/websiteoverview/ class=md-nav__link> Website Overview </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/datatables/ class=md-nav__link> DataTables </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/runpages/ class=md-nav__link> Pipeline Run Pages </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/sourcequery/ class=md-nav__link> Source Query </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/sourceanalysis/ class=md-nav__link> Source Î·-V Analysis </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/sourcedetail/ class=md-nav__link> Source Detail </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/sourcetagsfavs/ class=md-nav__link> Source Tags & Favourites </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/measurementpages/ class=md-nav__link> Measurement Pages </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/imagepages/ class=md-nav__link> Image Pages </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_11 type=checkbox id=__nav_3_11> <label class=md-nav__link for=__nav_3_11> Pipeline Outputs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Pipeline Outputs" data-md-level=2> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> Pipeline Outputs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../outputs/outputs/ class=md-nav__link> Outputs Overview </a> </li> <li class=md-nav__item> <a href=../../outputs/usingoutputs/ class=md-nav__link> Using the Outputs </a> </li> <li class=md-nav__item> <a href=../../outputs/coldesc/ class=md-nav__link> Column Descriptions </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_12 type=checkbox id=__nav_3_12> <label class=md-nav__link for=__nav_3_12> Admin Usage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Admin Usage" data-md-level=2> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Admin Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../adminusage/cli/ class=md-nav__link> CLI </a> </li> <li class=md-nav__item> <a href=../../adminusage/ingestimages/ class=md-nav__link> Standalone Image Ingestion </a> </li> <li class=md-nav__item> <a href=../../adminusage/app/ class=md-nav__link> Web App </a> </li> <li class=md-nav__item> <a href=../../exploringwebsite/admintools/ class=md-nav__link> Web App Admin Tools </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Features & Design <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Features & Design" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Features & Design </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../design/overview/ class=md-nav__link> Pipeline Steps Overview </a> </li> <li class=md-nav__item> <a href=../../design/imageingest/ class=md-nav__link> Image & Selavy Catalogue Ingest </a> </li> <li class=md-nav__item> <a href=../../design/association/ class=md-nav__link> Source Association </a> </li> <li class=md-nav__item> <a href=../../design/newsources/ class=md-nav__link> New Sources </a> </li> <li class=md-nav__item> <a href=../../design/monitor/ class=md-nav__link> Forced Measurements </a> </li> <li class=md-nav__item> <a href=../../design/sourcestats/ class=md-nav__link> Source Statistics </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_7 type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7> Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Architecture data-md-level=2> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/intro/ class=md-nav__link> Architecture Overview </a> </li> <li class=md-nav__item> <a href=../../architecture/database/ class=md-nav__link> Database Schema </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Contributing and Developing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Contributing and Developing" data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Contributing and Developing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developing/intro/ class=md-nav__link> Development Guidlines </a> </li> <li class=md-nav__item> <a href=../../developing/github/ class=md-nav__link> GitHub Platform </a> </li> <li class=md-nav__item> <a href=../../developing/localdevenv/ class=md-nav__link> Local Development Environment </a> </li> <li class=md-nav__item> <a href=../../developing/tests/ class=md-nav__link> Tests </a> </li> <li class=md-nav__item> <a href=../../developing/docsdev/ class=md-nav__link> Documentation </a> </li> <li class=md-nav__item> <a href=../../developing/profiling/ class=md-nav__link> Benchmarks </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../../help_and_acknowledgements/ class=md-nav__link> Help and Acknowledgements </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8 checked> <label class=md-nav__link for=__nav_8> Reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Reference data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> Changelog </a> </li> <li class=md-nav__item> <a href=../../code_of_conduct/ class=md-nav__link> Code of Conduct </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> License </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4 type=checkbox id=__nav_8_4 checked> <label class=md-nav__link for=__nav_8_4> Code Reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Code Reference" data-md-level=2> <label class=md-nav__title for=__nav_8_4> <span class="md-nav__icon md-icon"></span> Code Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1 type=checkbox id=__nav_8_4_1 checked> <label class=md-nav__link for=__nav_8_4_1> vast_pipeline <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=vast_pipeline data-md-level=3> <label class=md-nav__title for=__nav_8_4_1> <span class="md-nav__icon md-icon"></span> vast_pipeline </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1_1 type=checkbox id=__nav_8_4_1_1> <label class=md-nav__link for=__nav_8_4_1_1> image <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=image data-md-level=4> <label class=md-nav__title for=__nav_8_4_1_1> <span class="md-nav__icon md-icon"></span> image </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../image/main/ class=md-nav__link> main.py </a> </li> <li class=md-nav__item> <a href=../image/utils/ class=md-nav__link> utils.py </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1_2 type=checkbox id=__nav_8_4_1_2> <label class=md-nav__link for=__nav_8_4_1_2> management <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=management data-md-level=4> <label class=md-nav__title for=__nav_8_4_1_2> <span class="md-nav__icon md-icon"></span> management </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1_2_1 type=checkbox id=__nav_8_4_1_2_1> <label class=md-nav__link for=__nav_8_4_1_2_1> commands <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=commands data-md-level=5> <label class=md-nav__title for=__nav_8_4_1_2_1> <span class="md-nav__icon md-icon"></span> commands </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../management/commands/clearpiperun/ class=md-nav__link> clearpiperun.py </a> </li> <li class=md-nav__item> <a href=../management/commands/createmeasarrow/ class=md-nav__link> createmeasarrow.py </a> </li> <li class=md-nav__item> <a href=../management/commands/debugrun/ class=md-nav__link> debugrun.py </a> </li> <li class=md-nav__item> <a href=../management/commands/ingestimages/ class=md-nav__link> ingestimages.py </a> </li> <li class=md-nav__item> <a href=../management/commands/initingest/ class=md-nav__link> initingest.py </a> </li> <li class=md-nav__item> <a href=../management/commands/initpiperun/ class=md-nav__link> initpiperun.py </a> </li> <li class=md-nav__item> <a href=../management/commands/restorepiperun/ class=md-nav__link> restorepiperun.py </a> </li> <li class=md-nav__item> <a href=../management/commands/runpipeline/ class=md-nav__link> runpipeline.py </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../management/helpers/ class=md-nav__link> helpers.py </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1_3 type=checkbox id=__nav_8_4_1_3> <label class=md-nav__link for=__nav_8_4_1_3> pipeline <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=pipeline data-md-level=4> <label class=md-nav__title for=__nav_8_4_1_3> <span class="md-nav__icon md-icon"></span> pipeline </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../pipeline/association/ class=md-nav__link> association.py </a> </li> <li class=md-nav__item> <a href=../pipeline/config/ class=md-nav__link> config.py </a> </li> <li class=md-nav__item> <a href=../pipeline/errors/ class=md-nav__link> errors.py </a> </li> <li class=md-nav__item> <a href=../pipeline/finalise/ class=md-nav__link> finalise.py </a> </li> <li class=md-nav__item> <a href=../pipeline/forced_extraction/ class=md-nav__link> forced_extraction.py </a> </li> <li class=md-nav__item> <a href=../pipeline/loading/ class=md-nav__link> loading.py </a> </li> <li class=md-nav__item> <a href=../pipeline/main/ class=md-nav__link> main.py </a> </li> <li class=md-nav__item> <a href=../pipeline/model_generator/ class=md-nav__link> model_generator.py </a> </li> <li class=md-nav__item> <a href=../pipeline/new_sources/ class=md-nav__link> new_sources.py </a> </li> <li class=md-nav__item> <a href=../pipeline/pairs/ class=md-nav__link> pairs.py </a> </li> <li class=md-nav__item> <a href=../pipeline/utils/ class=md-nav__link> utils.py </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1_4 type=checkbox id=__nav_8_4_1_4> <label class=md-nav__link for=__nav_8_4_1_4> survey <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=survey data-md-level=4> <label class=md-nav__title for=__nav_8_4_1_4> <span class="md-nav__icon md-icon"></span> survey </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../survey/translators/ class=md-nav__link> translators.py </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_4_1_5 type=checkbox id=__nav_8_4_1_5> <label class=md-nav__link for=__nav_8_4_1_5> utils <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=utils data-md-level=4> <label class=md-nav__title for=__nav_8_4_1_5> <span class="md-nav__icon md-icon"></span> utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../utils/auth/ class=md-nav__link> auth.py </a> </li> <li class=md-nav__item> <a href=../utils/external_query/ class=md-nav__link> external_query.py </a> </li> <li class=md-nav__item> <a href=../utils/unit_tags/ class=md-nav__link> unit_tags.py </a> </li> <li class=md-nav__item> <a href=../utils/utils/ class=md-nav__link> utils.py </a> </li> <li class=md-nav__item> <a href=../utils/view/ class=md-nav__link> view.py </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../admin/ class=md-nav__link> admin.py </a> </li> <li class=md-nav__item> <a href=../apps/ class=md-nav__link> apps.py </a> </li> <li class=md-nav__item> <a href=../context_processors/ class=md-nav__link> context_processors.py </a> </li> <li class=md-nav__item> <a href=../converters/ class=md-nav__link> converters.py </a> </li> <li class=md-nav__item> <a href=../forms/ class=md-nav__link> forms.py </a> </li> <li class=md-nav__item> <a href=../models/ class=md-nav__link> models.py </a> </li> <li class=md-nav__item> <a href=../plots/ class=md-nav__link> plots.py </a> </li> <li class=md-nav__item> <a href=../serializers/ class=md-nav__link> serializers.py </a> </li> <li class=md-nav__item> <a href=../signals/ class=md-nav__link> signals.py </a> </li> <li class=md-nav__item> <a href=../urls/ class=md-nav__link> urls.py </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> views.py <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> views.py </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#vast_pipeline.views class=md-nav__link> vast_pipeline.views </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.MeasurementQuery class=md-nav__link> MeasurementQuery </a> <nav class=md-nav aria-label=MeasurementQuery> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.MeasurementQuery.get class=md-nav__link> get() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RawImageListSet class=md-nav__link> RawImageListSet </a> <nav class=md-nav aria-label=RawImageListSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.RawImageListSet.gen_title_data_tokens class=md-nav__link> gen_title_data_tokens() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet class=md-nav__link> RunViewSet </a> <nav class=md-nav aria-label=RunViewSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.delete class=md-nav__link> delete() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.genarrow class=md-nav__link> genarrow() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.restore class=md-nav__link> restore() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.run class=md-nav__link> run() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourcePlotsSet class=md-nav__link> SourcePlotsSet </a> <nav class=md-nav aria-label=SourcePlotsSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.SourcePlotsSet.etavplot class=md-nav__link> etavplot() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourcePlotsSet.lightcurve class=md-nav__link> lightcurve() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceViewSet class=md-nav__link> SourceViewSet </a> <nav class=md-nav aria-label=SourceViewSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceViewSet.list class=md-nav__link> list() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet class=md-nav__link> UtilitiesSet </a> <nav class=md-nav aria-label=UtilitiesSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet.coordinate_validator class=md-nav__link> coordinate_validator() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet.external_search class=md-nav__link> external_search() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet.sesame_search class=md-nav__link> sesame_search() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceEtaVPlot class=md-nav__link> SourceEtaVPlot() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceEtaVPlotUpdate class=md-nav__link> SourceEtaVPlotUpdate() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views._process_comment_form_get_comments class=md-nav__link> _process_comment_form_get_comments() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#vast_pipeline.views class=md-nav__link> vast_pipeline.views </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.MeasurementQuery class=md-nav__link> MeasurementQuery </a> <nav class=md-nav aria-label=MeasurementQuery> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.MeasurementQuery.get class=md-nav__link> get() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RawImageListSet class=md-nav__link> RawImageListSet </a> <nav class=md-nav aria-label=RawImageListSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.RawImageListSet.gen_title_data_tokens class=md-nav__link> gen_title_data_tokens() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet class=md-nav__link> RunViewSet </a> <nav class=md-nav aria-label=RunViewSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.delete class=md-nav__link> delete() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.genarrow class=md-nav__link> genarrow() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.restore class=md-nav__link> restore() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.RunViewSet.run class=md-nav__link> run() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourcePlotsSet class=md-nav__link> SourcePlotsSet </a> <nav class=md-nav aria-label=SourcePlotsSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.SourcePlotsSet.etavplot class=md-nav__link> etavplot() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourcePlotsSet.lightcurve class=md-nav__link> lightcurve() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceViewSet class=md-nav__link> SourceViewSet </a> <nav class=md-nav aria-label=SourceViewSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceViewSet.list class=md-nav__link> list() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet class=md-nav__link> UtilitiesSet </a> <nav class=md-nav aria-label=UtilitiesSet> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet.coordinate_validator class=md-nav__link> coordinate_validator() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet.external_search class=md-nav__link> external_search() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.UtilitiesSet.sesame_search class=md-nav__link> sesame_search() </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceEtaVPlot class=md-nav__link> SourceEtaVPlot() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views.SourceEtaVPlotUpdate class=md-nav__link> SourceEtaVPlotUpdate() </a> </li> <li class=md-nav__item> <a href=#vast_pipeline.views._process_comment_form_get_comments class=md-nav__link> _process_comment_form_get_comments() </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/askap-vast/vast-pipeline/tree/dev/vast_pipeline/views.py title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>views.py</h1> <div class="doc doc-object doc-module"> <a id=vast_pipeline.views></a> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=vast_pipeline.views.MeasurementQuery class="doc doc-heading"> <code>MeasurementQuery</code> <a href=#vast_pipeline.views.MeasurementQuery class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="rest_framework.views.APIView">APIView</span></code></p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1983</span>
<span class=normal>1984</span>
<span class=normal>1985</span>
<span class=normal>1986</span>
<span class=normal>1987</span>
<span class=normal>1988</span>
<span class=normal>1989</span>
<span class=normal>1990</span>
<span class=normal>1991</span>
<span class=normal>1992</span>
<span class=normal>1993</span>
<span class=normal>1994</span>
<span class=normal>1995</span>
<span class=normal>1996</span>
<span class=normal>1997</span>
<span class=normal>1998</span>
<span class=normal>1999</span>
<span class=normal>2000</span>
<span class=normal>2001</span>
<span class=normal>2002</span>
<span class=normal>2003</span>
<span class=normal>2004</span>
<span class=normal>2005</span>
<span class=normal>2006</span>
<span class=normal>2007</span>
<span class=normal>2008</span>
<span class=normal>2009</span>
<span class=normal>2010</span>
<span class=normal>2011</span>
<span class=normal>2012</span>
<span class=normal>2013</span>
<span class=normal>2014</span>
<span class=normal>2015</span>
<span class=normal>2016</span>
<span class=normal>2017</span>
<span class=normal>2018</span>
<span class=normal>2019</span>
<span class=normal>2020</span>
<span class=normal>2021</span>
<span class=normal>2022</span>
<span class=normal>2023</span>
<span class=normal>2024</span>
<span class=normal>2025</span>
<span class=normal>2026</span>
<span class=normal>2027</span>
<span class=normal>2028</span>
<span class=normal>2029</span>
<span class=normal>2030</span>
<span class=normal>2031</span>
<span class=normal>2032</span>
<span class=normal>2033</span>
<span class=normal>2034</span>
<span class=normal>2035</span>
<span class=normal>2036</span>
<span class=normal>2037</span>
<span class=normal>2038</span>
<span class=normal>2039</span>
<span class=normal>2040</span>
<span class=normal>2041</span>
<span class=normal>2042</span>
<span class=normal>2043</span>
<span class=normal>2044</span>
<span class=normal>2045</span>
<span class=normal>2046</span>
<span class=normal>2047</span>
<span class=normal>2048</span>
<span class=normal>2049</span>
<span class=normal>2050</span>
<span class=normal>2051</span>
<span class=normal>2052</span>
<span class=normal>2053</span>
<span class=normal>2054</span>
<span class=normal>2055</span>
<span class=normal>2056</span>
<span class=normal>2057</span>
<span class=normal>2058</span>
<span class=normal>2059</span>
<span class=normal>2060</span>
<span class=normal>2061</span>
<span class=normal>2062</span>
<span class=normal>2063</span>
<span class=normal>2064</span>
<span class=normal>2065</span>
<span class=normal>2066</span>
<span class=normal>2067</span>
<span class=normal>2068</span>
<span class=normal>2069</span>
<span class=normal>2070</span>
<span class=normal>2071</span>
<span class=normal>2072</span>
<span class=normal>2073</span>
<span class=normal>2074</span>
<span class=normal>2075</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>MeasurementQuery</span><span class=p>(</span><span class=n>APIView</span><span class=p>):</span>
    <span class=n>authentication_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>SessionAuthentication</span><span class=p>,</span> <span class=n>BasicAuthentication</span><span class=p>]</span>
    <span class=n>permission_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>IsAuthenticated</span><span class=p>]</span>

    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span>
        <span class=n>ra_deg</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
        <span class=n>dec_deg</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
        <span class=n>image_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
        <span class=n>radius_deg</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>FileResponse</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;Return a DS9/JS9 region file for all Measurement objects for a given cone search</span>
<span class=sd>        on an Image. Optionally highlight sources based on a Measurement or Source ID.</span>

<span class=sd>        Args:</span>
<span class=sd>            request: Django HTTPRequest. Supports 4 URL GET parameters:</span>
<span class=sd>                - selection_model: either &quot;measurement&quot; or &quot;source&quot; (defaults to &quot;measurement&quot;).</span>
<span class=sd>                - selection_id: the id for the given `selection_model`.</span>
<span class=sd>                - run_id: (optional) only return measurements for sources with the given pipeline</span>
<span class=sd>                    run id (defaults to None).</span>
<span class=sd>                - no_forced: (optional) If true, exclude forced-photometry measurements (defaults</span>
<span class=sd>                    to False).</span>
<span class=sd>                Measurement objects that match the given selection criterion will be</span>
<span class=sd>                highlighted. e.g. ?selection_model=measurement&amp;selection_id=100 will highlight</span>
<span class=sd>                the Measurement object with id=100. ?selection_model=source&amp;selection_id=5</span>
<span class=sd>                will highlight all Measurement objects associated with the Source object with</span>
<span class=sd>                id=5.</span>
<span class=sd>            ra_deg: Cone search RA in decimal degrees.</span>
<span class=sd>            dec_deg: Cone search Dec in decimal degrees.</span>
<span class=sd>            image_id: Primary key (id) of the Image object to search.</span>
<span class=sd>            radius_deg: Cone search radius in decimal degrees.</span>

<span class=sd>        Returns:</span>
<span class=sd>            FileResponse: Django FileReponse containing a DS9/JS9 region file.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;ra&quot;</span><span class=p>,</span> <span class=s2>&quot;dec&quot;</span><span class=p>,</span> <span class=s2>&quot;bmaj&quot;</span><span class=p>,</span> <span class=s2>&quot;bmin&quot;</span><span class=p>,</span> <span class=s2>&quot;pa&quot;</span><span class=p>,</span> <span class=s2>&quot;forced&quot;</span><span class=p>,</span> <span class=s2>&quot;source&quot;</span><span class=p>,</span> <span class=s2>&quot;source__name&quot;</span><span class=p>]</span>
        <span class=n>selection_model</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;selection_model&quot;</span><span class=p>,</span> <span class=s2>&quot;measurement&quot;</span><span class=p>)</span>
        <span class=n>selection_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;selection_id&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=n>run_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;run_id&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
        <span class=n>no_forced</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;forced&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>

        <span class=c1># validate selection query params</span>
        <span class=k>if</span> <span class=n>selection_id</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>selection_model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;measurement&quot;</span><span class=p>,</span> <span class=s2>&quot;source&quot;</span><span class=p>):</span>
                <span class=k>raise</span> <span class=n>Http404</span><span class=p>(</span><span class=s2>&quot;GET param selection_model must be either &#39;measurement&#39; or &#39;source&#39;.&quot;</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>selection_model</span> <span class=o>==</span> <span class=s2>&quot;measurement&quot;</span><span class=p>:</span>
                <span class=n>selection_attr</span> <span class=o>=</span> <span class=s2>&quot;id&quot;</span>
                <span class=n>selection_name</span> <span class=o>=</span> <span class=s2>&quot;name&quot;</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>selection_attr</span> <span class=o>=</span> <span class=n>selection_model</span>
                <span class=n>selection_name</span> <span class=o>=</span> <span class=s2>&quot;source__name&quot;</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>selection_id</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>selection_id</span><span class=p>)</span>
            <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
                <span class=k>raise</span> <span class=n>Http404</span><span class=p>(</span><span class=s2>&quot;GET param selection_id must be an integer.&quot;</span><span class=p>)</span>

        <span class=n>measurements</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>Measurement</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>image</span><span class=o>=</span><span class=n>image_id</span><span class=p>)</span>
            <span class=o>.</span><span class=n>cone_search</span><span class=p>(</span><span class=n>ra_deg</span><span class=p>,</span> <span class=n>dec_deg</span><span class=p>,</span> <span class=n>radius_deg</span><span class=p>)</span>
            <span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=o>*</span><span class=n>columns</span><span class=p>,</span> <span class=n>__name</span><span class=o>=</span><span class=n>F</span><span class=p>(</span><span class=n>selection_name</span><span class=p>))</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>run_id</span><span class=p>:</span>
            <span class=n>measurements</span> <span class=o>=</span> <span class=n>measurements</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>source__run__id</span><span class=o>=</span><span class=n>run_id</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>no_forced</span><span class=p>:</span>
            <span class=n>measurements</span> <span class=o>=</span> <span class=n>measurements</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>forced</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
        <span class=n>measurement_region_file</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>StringIO</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>meas</span> <span class=ow>in</span> <span class=n>measurements</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>selection_id</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>color</span> <span class=o>=</span> <span class=s2>&quot;#FF0000&quot;</span> <span class=k>if</span> <span class=n>meas</span><span class=p>[</span><span class=n>selection_attr</span><span class=p>]</span> <span class=o>==</span> <span class=n>selection_id</span> <span class=k>else</span> <span class=s2>&quot;#0000FF&quot;</span>
            <span class=n>shape</span> <span class=o>=</span> <span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;ellipse(</span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;ra&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>d, </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;dec&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>d, </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;bmaj&#39;</span><span class=p>]</span><span class=si>}</span><span class=se>\&quot;</span><span class=s2>, </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;bmin&#39;</span><span class=p>]</span><span class=si>}</span><span class=se>\&quot;</span><span class=s2>, &quot;</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;pa&#39;</span><span class=p>]</span><span class=o>+</span><span class=mi>90</span><span class=o>+</span><span class=mi>180</span><span class=si>}</span><span class=s2>d)&quot;</span>
            <span class=p>)</span>
            <span class=n>properties</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s2>&quot;color&quot;</span><span class=p>:</span> <span class=n>color</span><span class=p>,</span>
                <span class=s2>&quot;data&quot;</span><span class=p>:</span> <span class=p>{</span>
                    <span class=s2>&quot;text&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>selection_model</span><span class=si>}</span><span class=s2> ID: </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=n>selection_attr</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                    <span class=s2>&quot;link&quot;</span><span class=p>:</span> <span class=n>reverse</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;vast_pipeline:</span><span class=si>{</span><span class=n>selection_model</span><span class=si>}</span><span class=s2>_detail&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>selection_id</span><span class=p>]),</span>
                <span class=p>}</span>
            <span class=p>}</span>
            <span class=k>if</span> <span class=n>meas</span><span class=p>[</span><span class=s2>&quot;forced&quot;</span><span class=p>]:</span>
                <span class=n>properties</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>strokeDashArray</span><span class=o>=</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
            <span class=n>region</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>shape</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>properties</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
            <span class=n>measurement_region_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>region</span><span class=p>)</span>
        <span class=n>measurement_region_file</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
        <span class=n>f</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>measurement_region_file</span><span class=o>.</span><span class=n>read</span><span class=p>(),</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&quot;utf8&quot;</span><span class=p>))</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>FileResponse</span><span class=p>(</span>
            <span class=n>f</span><span class=p>,</span>
            <span class=n>as_attachment</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
            <span class=n>filename</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;image-</span><span class=si>{</span><span class=n>image_id</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>ra_deg</span><span class=si>:</span><span class=s2>.5f</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>dec_deg</span><span class=si>:</span><span class=s2>+.5f</span><span class=si>}</span><span class=s2>_radius-</span><span class=si>{</span><span class=n>radius_deg</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>.reg&quot;</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>response</span>
</code></pre></div> </td></tr></table> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.MeasurementQuery.get class="doc doc-heading"> <code class="highlight language-python"><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>ra_deg</span><span class=p>,</span> <span class=n>dec_deg</span><span class=p>,</span> <span class=n>image_id</span><span class=p>,</span> <span class=n>radius_deg</span><span class=p>)</span></code> <a href=#vast_pipeline.views.MeasurementQuery.get class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Return a DS9/JS9 region file for all Measurement objects for a given cone search on an Image. Optionally highlight sources based on a Measurement or Source ID.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django HTTPRequest. Supports 4 URL GET parameters: - selection_model: either "measurement" or "source" (defaults to "measurement"). - selection_id: the id for the given <code>selection_model</code>. - run_id: (optional) only return measurements for sources with the given pipeline run id (defaults to None). - no_forced: (optional) If true, exclude forced-photometry measurements (defaults to False). Measurement objects that match the given selection criterion will be highlighted. e.g. ?selection_model=measurement&amp;selection_id=100 will highlight the Measurement object with id=100. ?selection_model=source&amp;selection_id=5 will highlight all Measurement objects associated with the Source object with id=5.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>ra_deg</code></td> <td> <code>float</code> </td> <td><p>Cone search RA in decimal degrees.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>dec_deg</code></td> <td> <code>float</code> </td> <td><p>Cone search Dec in decimal degrees.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>image_id</code></td> <td> <code>int</code> </td> <td><p>Primary key (id) of the Image object to search.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>radius_deg</code></td> <td> <code>float</code> </td> <td><p>Cone search radius in decimal degrees.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>FileResponse</code></td> <td> <code><span title="django.http.FileResponse">FileResponse</span></code> </td> <td><p>Django FileReponse containing a DS9/JS9 region file.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1987</span>
<span class=normal>1988</span>
<span class=normal>1989</span>
<span class=normal>1990</span>
<span class=normal>1991</span>
<span class=normal>1992</span>
<span class=normal>1993</span>
<span class=normal>1994</span>
<span class=normal>1995</span>
<span class=normal>1996</span>
<span class=normal>1997</span>
<span class=normal>1998</span>
<span class=normal>1999</span>
<span class=normal>2000</span>
<span class=normal>2001</span>
<span class=normal>2002</span>
<span class=normal>2003</span>
<span class=normal>2004</span>
<span class=normal>2005</span>
<span class=normal>2006</span>
<span class=normal>2007</span>
<span class=normal>2008</span>
<span class=normal>2009</span>
<span class=normal>2010</span>
<span class=normal>2011</span>
<span class=normal>2012</span>
<span class=normal>2013</span>
<span class=normal>2014</span>
<span class=normal>2015</span>
<span class=normal>2016</span>
<span class=normal>2017</span>
<span class=normal>2018</span>
<span class=normal>2019</span>
<span class=normal>2020</span>
<span class=normal>2021</span>
<span class=normal>2022</span>
<span class=normal>2023</span>
<span class=normal>2024</span>
<span class=normal>2025</span>
<span class=normal>2026</span>
<span class=normal>2027</span>
<span class=normal>2028</span>
<span class=normal>2029</span>
<span class=normal>2030</span>
<span class=normal>2031</span>
<span class=normal>2032</span>
<span class=normal>2033</span>
<span class=normal>2034</span>
<span class=normal>2035</span>
<span class=normal>2036</span>
<span class=normal>2037</span>
<span class=normal>2038</span>
<span class=normal>2039</span>
<span class=normal>2040</span>
<span class=normal>2041</span>
<span class=normal>2042</span>
<span class=normal>2043</span>
<span class=normal>2044</span>
<span class=normal>2045</span>
<span class=normal>2046</span>
<span class=normal>2047</span>
<span class=normal>2048</span>
<span class=normal>2049</span>
<span class=normal>2050</span>
<span class=normal>2051</span>
<span class=normal>2052</span>
<span class=normal>2053</span>
<span class=normal>2054</span>
<span class=normal>2055</span>
<span class=normal>2056</span>
<span class=normal>2057</span>
<span class=normal>2058</span>
<span class=normal>2059</span>
<span class=normal>2060</span>
<span class=normal>2061</span>
<span class=normal>2062</span>
<span class=normal>2063</span>
<span class=normal>2064</span>
<span class=normal>2065</span>
<span class=normal>2066</span>
<span class=normal>2067</span>
<span class=normal>2068</span>
<span class=normal>2069</span>
<span class=normal>2070</span>
<span class=normal>2071</span>
<span class=normal>2072</span>
<span class=normal>2073</span>
<span class=normal>2074</span>
<span class=normal>2075</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>get</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span>
    <span class=n>ra_deg</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
    <span class=n>dec_deg</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
    <span class=n>image_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
    <span class=n>radius_deg</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>FileResponse</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;Return a DS9/JS9 region file for all Measurement objects for a given cone search</span>
<span class=sd>    on an Image. Optionally highlight sources based on a Measurement or Source ID.</span>

<span class=sd>    Args:</span>
<span class=sd>        request: Django HTTPRequest. Supports 4 URL GET parameters:</span>
<span class=sd>            - selection_model: either &quot;measurement&quot; or &quot;source&quot; (defaults to &quot;measurement&quot;).</span>
<span class=sd>            - selection_id: the id for the given `selection_model`.</span>
<span class=sd>            - run_id: (optional) only return measurements for sources with the given pipeline</span>
<span class=sd>                run id (defaults to None).</span>
<span class=sd>            - no_forced: (optional) If true, exclude forced-photometry measurements (defaults</span>
<span class=sd>                to False).</span>
<span class=sd>            Measurement objects that match the given selection criterion will be</span>
<span class=sd>            highlighted. e.g. ?selection_model=measurement&amp;selection_id=100 will highlight</span>
<span class=sd>            the Measurement object with id=100. ?selection_model=source&amp;selection_id=5</span>
<span class=sd>            will highlight all Measurement objects associated with the Source object with</span>
<span class=sd>            id=5.</span>
<span class=sd>        ra_deg: Cone search RA in decimal degrees.</span>
<span class=sd>        dec_deg: Cone search Dec in decimal degrees.</span>
<span class=sd>        image_id: Primary key (id) of the Image object to search.</span>
<span class=sd>        radius_deg: Cone search radius in decimal degrees.</span>

<span class=sd>    Returns:</span>
<span class=sd>        FileResponse: Django FileReponse containing a DS9/JS9 region file.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;ra&quot;</span><span class=p>,</span> <span class=s2>&quot;dec&quot;</span><span class=p>,</span> <span class=s2>&quot;bmaj&quot;</span><span class=p>,</span> <span class=s2>&quot;bmin&quot;</span><span class=p>,</span> <span class=s2>&quot;pa&quot;</span><span class=p>,</span> <span class=s2>&quot;forced&quot;</span><span class=p>,</span> <span class=s2>&quot;source&quot;</span><span class=p>,</span> <span class=s2>&quot;source__name&quot;</span><span class=p>]</span>
    <span class=n>selection_model</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;selection_model&quot;</span><span class=p>,</span> <span class=s2>&quot;measurement&quot;</span><span class=p>)</span>
    <span class=n>selection_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;selection_id&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>run_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;run_id&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>no_forced</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;forced&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>

    <span class=c1># validate selection query params</span>
    <span class=k>if</span> <span class=n>selection_id</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>selection_model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>(</span><span class=s2>&quot;measurement&quot;</span><span class=p>,</span> <span class=s2>&quot;source&quot;</span><span class=p>):</span>
            <span class=k>raise</span> <span class=n>Http404</span><span class=p>(</span><span class=s2>&quot;GET param selection_model must be either &#39;measurement&#39; or &#39;source&#39;.&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>selection_model</span> <span class=o>==</span> <span class=s2>&quot;measurement&quot;</span><span class=p>:</span>
            <span class=n>selection_attr</span> <span class=o>=</span> <span class=s2>&quot;id&quot;</span>
            <span class=n>selection_name</span> <span class=o>=</span> <span class=s2>&quot;name&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>selection_attr</span> <span class=o>=</span> <span class=n>selection_model</span>
            <span class=n>selection_name</span> <span class=o>=</span> <span class=s2>&quot;source__name&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>selection_id</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>selection_id</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>Http404</span><span class=p>(</span><span class=s2>&quot;GET param selection_id must be an integer.&quot;</span><span class=p>)</span>

    <span class=n>measurements</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>Measurement</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>image</span><span class=o>=</span><span class=n>image_id</span><span class=p>)</span>
        <span class=o>.</span><span class=n>cone_search</span><span class=p>(</span><span class=n>ra_deg</span><span class=p>,</span> <span class=n>dec_deg</span><span class=p>,</span> <span class=n>radius_deg</span><span class=p>)</span>
        <span class=o>.</span><span class=n>values</span><span class=p>(</span><span class=o>*</span><span class=n>columns</span><span class=p>,</span> <span class=n>__name</span><span class=o>=</span><span class=n>F</span><span class=p>(</span><span class=n>selection_name</span><span class=p>))</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>run_id</span><span class=p>:</span>
        <span class=n>measurements</span> <span class=o>=</span> <span class=n>measurements</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>source__run__id</span><span class=o>=</span><span class=n>run_id</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>no_forced</span><span class=p>:</span>
        <span class=n>measurements</span> <span class=o>=</span> <span class=n>measurements</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>forced</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=n>measurement_region_file</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>StringIO</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>meas</span> <span class=ow>in</span> <span class=n>measurements</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>selection_id</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>color</span> <span class=o>=</span> <span class=s2>&quot;#FF0000&quot;</span> <span class=k>if</span> <span class=n>meas</span><span class=p>[</span><span class=n>selection_attr</span><span class=p>]</span> <span class=o>==</span> <span class=n>selection_id</span> <span class=k>else</span> <span class=s2>&quot;#0000FF&quot;</span>
        <span class=n>shape</span> <span class=o>=</span> <span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;ellipse(</span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;ra&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>d, </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;dec&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>d, </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;bmaj&#39;</span><span class=p>]</span><span class=si>}</span><span class=se>\&quot;</span><span class=s2>, </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;bmin&#39;</span><span class=p>]</span><span class=si>}</span><span class=se>\&quot;</span><span class=s2>, &quot;</span>
            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=s1>&#39;pa&#39;</span><span class=p>]</span><span class=o>+</span><span class=mi>90</span><span class=o>+</span><span class=mi>180</span><span class=si>}</span><span class=s2>d)&quot;</span>
        <span class=p>)</span>
        <span class=n>properties</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;color&quot;</span><span class=p>:</span> <span class=n>color</span><span class=p>,</span>
            <span class=s2>&quot;data&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;text&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>selection_model</span><span class=si>}</span><span class=s2> ID: </span><span class=si>{</span><span class=n>meas</span><span class=p>[</span><span class=n>selection_attr</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
                <span class=s2>&quot;link&quot;</span><span class=p>:</span> <span class=n>reverse</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;vast_pipeline:</span><span class=si>{</span><span class=n>selection_model</span><span class=si>}</span><span class=s2>_detail&quot;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>selection_id</span><span class=p>]),</span>
            <span class=p>}</span>
        <span class=p>}</span>
        <span class=k>if</span> <span class=n>meas</span><span class=p>[</span><span class=s2>&quot;forced&quot;</span><span class=p>]:</span>
            <span class=n>properties</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>strokeDashArray</span><span class=o>=</span><span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span>
        <span class=n>region</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>shape</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>properties</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
        <span class=n>measurement_region_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>region</span><span class=p>)</span>
    <span class=n>measurement_region_file</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
    <span class=n>f</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>measurement_region_file</span><span class=o>.</span><span class=n>read</span><span class=p>(),</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&quot;utf8&quot;</span><span class=p>))</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>FileResponse</span><span class=p>(</span>
        <span class=n>f</span><span class=p>,</span>
        <span class=n>as_attachment</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>filename</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;image-</span><span class=si>{</span><span class=n>image_id</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>ra_deg</span><span class=si>:</span><span class=s2>.5f</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>dec_deg</span><span class=si>:</span><span class=s2>+.5f</span><span class=si>}</span><span class=s2>_radius-</span><span class=si>{</span><span class=n>radius_deg</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>.reg&quot;</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=n>response</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=vast_pipeline.views.RawImageListSet class="doc doc-heading"> <code>RawImageListSet</code> <a href=#vast_pipeline.views.RawImageListSet class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="rest_framework.viewsets.ViewSet">ViewSet</span></code></p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2078</span>
<span class=normal>2079</span>
<span class=normal>2080</span>
<span class=normal>2081</span>
<span class=normal>2082</span>
<span class=normal>2083</span>
<span class=normal>2084</span>
<span class=normal>2085</span>
<span class=normal>2086</span>
<span class=normal>2087</span>
<span class=normal>2088</span>
<span class=normal>2089</span>
<span class=normal>2090</span>
<span class=normal>2091</span>
<span class=normal>2092</span>
<span class=normal>2093</span>
<span class=normal>2094</span>
<span class=normal>2095</span>
<span class=normal>2096</span>
<span class=normal>2097</span>
<span class=normal>2098</span>
<span class=normal>2099</span>
<span class=normal>2100</span>
<span class=normal>2101</span>
<span class=normal>2102</span>
<span class=normal>2103</span>
<span class=normal>2104</span>
<span class=normal>2105</span>
<span class=normal>2106</span>
<span class=normal>2107</span>
<span class=normal>2108</span>
<span class=normal>2109</span>
<span class=normal>2110</span>
<span class=normal>2111</span>
<span class=normal>2112</span>
<span class=normal>2113</span>
<span class=normal>2114</span>
<span class=normal>2115</span>
<span class=normal>2116</span>
<span class=normal>2117</span>
<span class=normal>2118</span>
<span class=normal>2119</span>
<span class=normal>2120</span>
<span class=normal>2121</span>
<span class=normal>2122</span>
<span class=normal>2123</span>
<span class=normal>2124</span>
<span class=normal>2125</span>
<span class=normal>2126</span>
<span class=normal>2127</span>
<span class=normal>2128</span>
<span class=normal>2129</span>
<span class=normal>2130</span>
<span class=normal>2131</span>
<span class=normal>2132</span>
<span class=normal>2133</span>
<span class=normal>2134</span>
<span class=normal>2135</span>
<span class=normal>2136</span>
<span class=normal>2137</span>
<span class=normal>2138</span>
<span class=normal>2139</span>
<span class=normal>2140</span>
<span class=normal>2141</span>
<span class=normal>2142</span>
<span class=normal>2143</span>
<span class=normal>2144</span>
<span class=normal>2145</span>
<span class=normal>2146</span>
<span class=normal>2147</span>
<span class=normal>2148</span>
<span class=normal>2149</span>
<span class=normal>2150</span>
<span class=normal>2151</span>
<span class=normal>2152</span>
<span class=normal>2153</span>
<span class=normal>2154</span>
<span class=normal>2155</span>
<span class=normal>2156</span>
<span class=normal>2157</span>
<span class=normal>2158</span>
<span class=normal>2159</span>
<span class=normal>2160</span>
<span class=normal>2161</span>
<span class=normal>2162</span>
<span class=normal>2163</span>
<span class=normal>2164</span>
<span class=normal>2165</span>
<span class=normal>2166</span>
<span class=normal>2167</span>
<span class=normal>2168</span>
<span class=normal>2169</span>
<span class=normal>2170</span>
<span class=normal>2171</span>
<span class=normal>2172</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>RawImageListSet</span><span class=p>(</span><span class=n>ViewSet</span><span class=p>):</span>
    <span class=n>authentication_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>SessionAuthentication</span><span class=p>,</span> <span class=n>BasicAuthentication</span><span class=p>]</span>
    <span class=n>permission_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>IsAuthenticated</span><span class=p>]</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>gen_title_data_tokens</span><span class=p>(</span><span class=n>list_of_paths</span><span class=p>):</span>
        <span class=sd>&#39;&#39;&#39;</span>
<span class=sd>        generate a dataframe with extra columns for HTML tags title</span>
<span class=sd>        and data-tokens to generate something like:</span>
<span class=sd>        &lt;option title={{title}} data-tokens={{datatokens}}&gt;{{path}}&lt;/option&gt;</span>
<span class=sd>        this assume a path like this:</span>
<span class=sd>        EPOCH06x/COMBINED/STOKESI_SELAVY/VAST_2118-06A.EPOCH06x.I.selavy.components.txt</span>
<span class=sd>        For the following dataframe columns</span>
<span class=sd>                                                     path</span>
<span class=sd>        EPOCH06x/COMBINED/STOKESI_SELAVY/VAST_2118-06A...</span>
<span class=sd>                                                 title</span>
<span class=sd>        VAST_2118-06A.EPOCH06x.I.selavy.components.txt</span>
<span class=sd>                                               datatokens</span>
<span class=sd>        EPOCH06x VAST_2118-06A.EPOCH06x.I.selavy.compo...</span>
<span class=sd>        &#39;&#39;&#39;</span>
        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>list_of_paths</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>])</span>
        <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>)</span>
        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>pat</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>sep</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;datatokens&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>df</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>pat</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>sep</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
            <span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>cat</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>],</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
        <span class=p>)</span>

        <span class=k>return</span> <span class=n>df</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=n>orient</span><span class=o>=</span><span class=s1>&#39;records&#39;</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>list</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
        <span class=c1># generate the folders path regex, e.g. /path/to/images/**/*.fits</span>
        <span class=c1># first generate the list of main subfolders, e.g. [EPOCH01, ... ]</span>
        <span class=n>img_root</span> <span class=o>=</span> <span class=n>settings</span><span class=o>.</span><span class=n>RAW_IMAGE_DIR</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>img_root</span><span class=p>):</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;Raw image folder does not exists&#39;</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
            <span class=k>raise</span> <span class=n>Http404</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>

        <span class=n>img_subfolders_gen</span> <span class=o>=</span> <span class=nb>filter</span><span class=p>(</span>
            <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>img_root</span><span class=p>,</span> <span class=n>x</span><span class=p>)),</span>
            <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>img_root</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=n>img_subfolders1</span><span class=p>,</span> <span class=n>img_subfolders2</span> <span class=o>=</span> <span class=n>tee</span><span class=p>(</span><span class=n>img_subfolders_gen</span><span class=p>)</span>
        <span class=n>img_regex_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span>
            <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>img_root</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=s1>&#39;**&#39;</span> <span class=o>+</span> <span class=n>os</span><span class=o>.</span><span class=n>sep</span> <span class=o>+</span> <span class=s1>&#39;*.fits&#39;</span><span class=p>),</span>
            <span class=n>img_subfolders1</span>
        <span class=p>))</span>
        <span class=n>selavy_regex_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span>
            <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>img_root</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=s1>&#39;**&#39;</span> <span class=o>+</span> <span class=n>os</span><span class=o>.</span><span class=n>sep</span> <span class=o>+</span> <span class=s1>&#39;*.txt&#39;</span><span class=p>),</span>
            <span class=n>img_subfolders2</span>
        <span class=p>))</span>
        <span class=c1># add home directory user data for user and jupyter-user (user = github name)</span>
        <span class=n>req_user</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>username</span>
        <span class=k>for</span> <span class=n>user</span> <span class=ow>in</span> <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>req_user</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;jupyter-</span><span class=si>{</span><span class=n>req_user</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]:</span>
            <span class=k>if</span> <span class=n>settings</span><span class=o>.</span><span class=n>HOME_DATA_ROOT</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>user_home_data</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
                    <span class=n>settings</span><span class=o>.</span><span class=n>HOME_DATA_ROOT</span><span class=p>,</span> <span class=n>user</span><span class=p>,</span> <span class=n>settings</span><span class=o>.</span><span class=n>HOME_DATA_DIR</span>
                <span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>user_home_data</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
                    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>expanduser</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;~</span><span class=si>{</span><span class=n>user</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>),</span> <span class=n>settings</span><span class=o>.</span><span class=n>HOME_DATA_DIR</span>
                <span class=p>)</span>
            <span class=k>if</span> <span class=n>settings</span><span class=o>.</span><span class=n>HOME_DATA_DIR</span> <span class=ow>and</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>user_home_data</span><span class=p>):</span>
                <span class=n>img_regex_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>user_home_data</span><span class=p>,</span> <span class=s1>&#39;**&#39;</span> <span class=o>+</span> <span class=n>os</span><span class=o>.</span><span class=n>sep</span> <span class=o>+</span> <span class=s1>&#39;*.fits&#39;</span><span class=p>))</span>
                <span class=n>selavy_regex_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>user_home_data</span><span class=p>,</span> <span class=s1>&#39;**&#39;</span> <span class=o>+</span> <span class=n>os</span><span class=o>.</span><span class=n>sep</span> <span class=o>+</span> <span class=s1>&#39;*.txt&#39;</span><span class=p>))</span>

        <span class=c1># generate raw image list in parallel</span>
        <span class=n>dask_list</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>from_sequence</span><span class=p>(</span><span class=n>img_regex_list</span><span class=p>)</span>
        <span class=n>fits_files</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>dask_list</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>glob</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>recursive</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
            <span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
            <span class=o>.</span><span class=n>compute</span><span class=p>()</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>fits_files</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;no fits files found&#39;</span><span class=p>)</span>

        <span class=c1># generate raw image list in parallel</span>
        <span class=n>dask_list</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>from_sequence</span><span class=p>(</span><span class=n>selavy_regex_list</span><span class=p>)</span>
        <span class=n>selavy_files</span> <span class=o>=</span> <span class=p>(</span>
            <span class=n>dask_list</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>glob</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>recursive</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
            <span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
            <span class=o>.</span><span class=n>compute</span><span class=p>()</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>fits_files</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;no selavy files found&#39;</span><span class=p>)</span>

        <span class=c1># generate response datastructure</span>
        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s1>&#39;fits&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>gen_title_data_tokens</span><span class=p>(</span><span class=n>fits_files</span><span class=p>),</span>
            <span class=s1>&#39;selavy&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>gen_title_data_tokens</span><span class=p>(</span><span class=n>selavy_files</span><span class=p>)</span>
        <span class=p>}</span>
        <span class=n>serializer</span> <span class=o>=</span> <span class=n>RawImageSelavyListSerializer</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.RawImageListSet.gen_title_data_tokens class="doc doc-heading"> <code class="highlight language-python"><span class=n>gen_title_data_tokens</span><span class=p>(</span><span class=n>list_of_paths</span><span class=p>)</span></code> <a href=#vast_pipeline.views.RawImageListSet.gen_title_data_tokens class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>generate a dataframe with extra columns for HTML tags title and data-tokens to generate something like:</p> <option title={{title}} data-tokens={{datatokens}}>{{path}}</option> <p>this assume a path like this: EPOCH06x/COMBINED/STOKESI_SELAVY/VAST_2118-06A.EPOCH06x.I.selavy.components.txt For the following dataframe columns path EPOCH06x/COMBINED/STOKESI_SELAVY/VAST_2118-06A... title VAST_2118-06A.EPOCH06x.I.selavy.components.txt datatokens EPOCH06x VAST_2118-06A.EPOCH06x.I.selavy.compo...</p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2082</span>
<span class=normal>2083</span>
<span class=normal>2084</span>
<span class=normal>2085</span>
<span class=normal>2086</span>
<span class=normal>2087</span>
<span class=normal>2088</span>
<span class=normal>2089</span>
<span class=normal>2090</span>
<span class=normal>2091</span>
<span class=normal>2092</span>
<span class=normal>2093</span>
<span class=normal>2094</span>
<span class=normal>2095</span>
<span class=normal>2096</span>
<span class=normal>2097</span>
<span class=normal>2098</span>
<span class=normal>2099</span>
<span class=normal>2100</span>
<span class=normal>2101</span>
<span class=normal>2102</span>
<span class=normal>2103</span>
<span class=normal>2104</span>
<span class=normal>2105</span>
<span class=normal>2106</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@staticmethod</span>
<span class=k>def</span> <span class=nf>gen_title_data_tokens</span><span class=p>(</span><span class=n>list_of_paths</span><span class=p>):</span>
    <span class=sd>&#39;&#39;&#39;</span>
<span class=sd>    generate a dataframe with extra columns for HTML tags title</span>
<span class=sd>    and data-tokens to generate something like:</span>
<span class=sd>    &lt;option title={{title}} data-tokens={{datatokens}}&gt;{{path}}&lt;/option&gt;</span>
<span class=sd>    this assume a path like this:</span>
<span class=sd>    EPOCH06x/COMBINED/STOKESI_SELAVY/VAST_2118-06A.EPOCH06x.I.selavy.components.txt</span>
<span class=sd>    For the following dataframe columns</span>
<span class=sd>                                                 path</span>
<span class=sd>    EPOCH06x/COMBINED/STOKESI_SELAVY/VAST_2118-06A...</span>
<span class=sd>                                             title</span>
<span class=sd>    VAST_2118-06A.EPOCH06x.I.selavy.components.txt</span>
<span class=sd>                                           datatokens</span>
<span class=sd>    EPOCH06x VAST_2118-06A.EPOCH06x.I.selavy.compo...</span>
<span class=sd>    &#39;&#39;&#39;</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>list_of_paths</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>])</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;path&#39;</span><span class=p>)</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>pat</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>sep</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;datatokens&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>pat</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>sep</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
        <span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>cat</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>],</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
    <span class=p>)</span>

    <span class=k>return</span> <span class=n>df</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(</span><span class=n>orient</span><span class=o>=</span><span class=s1>&#39;records&#39;</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=vast_pipeline.views.RunViewSet class="doc doc-heading"> <code>RunViewSet</code> <a href=#vast_pipeline.views.RunViewSet class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="rest_framework.viewsets.ModelViewSet">ModelViewSet</span></code></p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span>
<span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>RunViewSet</span><span class=p>(</span><span class=n>ModelViewSet</span><span class=p>):</span>
    <span class=n>authentication_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>SessionAuthentication</span><span class=p>,</span> <span class=n>BasicAuthentication</span><span class=p>]</span>
    <span class=n>permission_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>IsAuthenticated</span><span class=p>]</span>
    <span class=n>queryset</span> <span class=o>=</span> <span class=n>Run</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>RunSerializer</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>images</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>run__id</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filter_queryset</span><span class=p>(</span><span class=n>qs</span><span class=p>)</span>
        <span class=n>page</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>paginate_queryset</span><span class=p>(</span><span class=n>qs</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>page</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>serializer</span> <span class=o>=</span> <span class=n>ImageSerializer</span><span class=p>(</span><span class=n>page</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_paginated_response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>

        <span class=n>serializer</span> <span class=o>=</span> <span class=n>ImageSerializer</span><span class=p>(</span><span class=n>qs</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>measurements</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=n>Measurement</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>image__run__in</span><span class=o>=</span><span class=p>[</span><span class=n>pk</span><span class=p>])</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filter_queryset</span><span class=p>(</span><span class=n>qs</span><span class=p>)</span>
        <span class=n>page</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>paginate_queryset</span><span class=p>(</span><span class=n>qs</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>page</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>serializer</span> <span class=o>=</span> <span class=n>MeasurementSerializer</span><span class=p>(</span><span class=n>page</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_paginated_response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>

        <span class=n>serializer</span> <span class=o>=</span> <span class=n>MeasurementSerializer</span><span class=p>(</span><span class=n>qs</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HttpResponseRedirect</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Launches a pipeline run using a Django Q cluster. Includes a check</span>
<span class=sd>        on ownership or admin stataus of the user to make sure processing</span>
<span class=sd>        is allowed.</span>

<span class=sd>        Args:</span>
<span class=sd>            request: Django REST Framework request object.</span>
<span class=sd>            pk: Run object primary key. Defaults to None.</span>

<span class=sd>        Raises:</span>
<span class=sd>            Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Response: Returns to the orignal request page (the pipeline run</span>
<span class=sd>                detail).</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in config write: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># make sure that only the run creator or an admin can request the run</span>
        <span class=c1># to be processed.</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># check that it&#39;s not already running or queued</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;RUN&quot;</span><span class=p>,</span> <span class=s2>&quot;QUE&quot;</span><span class=p>,</span> <span class=s2>&quot;RES&quot;</span><span class=p>]:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is already running, queued or restoring.&#39;</span>
                <span class=s1>&#39; Please wait for the run to complete before trying to&#39;</span>
                <span class=s1>&#39; submit again.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>if</span> <span class=n>Run</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>check_max_runs</span><span class=p>(</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=p>):</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
                <span class=s1>&#39;The maximum number of simultaneous pipeline runs has been&#39;</span>
                <span class=sa>f</span><span class=s1>&#39; reached (</span><span class=si>{</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=si>}</span><span class=s1>)! Please try again&#39;</span>
                <span class=s1>&#39; when other jobs have finished.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=n>prev_status</span> <span class=o>=</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;QUE&#39;</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>

            <span class=n>debug_flag</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;debug&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=kc>False</span>
            <span class=n>full_rerun</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;fullReRun&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=kc>False</span>

            <span class=n>async_task</span><span class=p>(</span>
                <span class=s1>&#39;vast_pipeline.management.commands.runpipeline.run_pipe&#39;</span><span class=p>,</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span> <span class=n>p_run</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=n>debug_flag</span><span class=p>,</span>
                <span class=n>task_name</span><span class=o>=</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>ack_failure</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=p>,</span>
                <span class=n>full_rerun</span><span class=o>=</span><span class=n>full_rerun</span><span class=p>,</span> <span class=n>prev_ui_status</span><span class=o>=</span><span class=n>prev_status</span>
            <span class=p>)</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;&lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully sent to the queue!&lt;br&gt;&lt;br&gt;Refresh the&#39;</span>
                <span class=s1>&#39; page to check the status.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in running pipeline: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
            <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_detail&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>p_run</span><span class=o>.</span><span class=n>id</span><span class=p>])</span>
        <span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>restore</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HttpResponseRedirect</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Launches a restore pipeline run using a Django Q cluster. Includes a</span>
<span class=sd>        check on ownership or admin status of the user to make sure</span>
<span class=sd>        processing is allowed.</span>

<span class=sd>        Args:</span>
<span class=sd>            request: Django REST Framework request object.</span>
<span class=sd>            pk: Run object primary key. Defaults to None.</span>

<span class=sd>        Raises:</span>
<span class=sd>            Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Response: Returns to the orignal request page (the pipeline run</span>
<span class=sd>                detail).</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in run fetch: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># make sure that only the run creator or an admin can request the run</span>
        <span class=c1># to be processed.</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># check that it&#39;s not already running or queued</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;RUN&quot;</span><span class=p>,</span> <span class=s2>&quot;QUE&quot;</span><span class=p>,</span> <span class=s2>&quot;RES&quot;</span><span class=p>,</span> <span class=s2>&quot;INI&quot;</span><span class=p>]:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is already running, queued, restoring or is &#39;</span>
                <span class=s1>&#39;only initialised. It cannot be restored at this time.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>if</span> <span class=n>Run</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>check_max_runs</span><span class=p>(</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=p>):</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
                <span class=s1>&#39;The maximum number of simultaneous pipeline runs has been&#39;</span>
                <span class=sa>f</span><span class=s1>&#39; reached (</span><span class=si>{</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=si>}</span><span class=s1>)! Please try again&#39;</span>
                <span class=s1>&#39; when other jobs have finished.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=n>prev_status</span> <span class=o>=</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>debug_flag</span> <span class=o>=</span> <span class=mi>3</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;restoreDebug&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=mi>1</span>

            <span class=n>async_task</span><span class=p>(</span>
                <span class=s1>&#39;django.core.management.call_command&#39;</span><span class=p>,</span>
                <span class=s1>&#39;restorepiperun&#39;</span><span class=p>,</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
                <span class=n>no_confirm</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=n>verbosity</span><span class=o>=</span><span class=n>debug_flag</span>
            <span class=p>)</span>

            <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;Restore &lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully sent to the queue!&lt;br&gt;&lt;br&gt;Refresh the&#39;</span>
                <span class=s1>&#39; page to check the status.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in restoring run: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
            <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_detail&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>p_run</span><span class=o>.</span><span class=n>id</span><span class=p>])</span>
        <span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>delete</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HttpResponseRedirect</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Launches the remove pipeline run using a Django Q cluster. Includes a</span>
<span class=sd>        check on ownership or admin status of the user to make sure</span>
<span class=sd>        deletion is allowed.</span>

<span class=sd>        Args:</span>
<span class=sd>            request (Request): Django REST Framework request object.</span>
<span class=sd>            pk (int, optional): Run object primary key. Defaults to None.</span>

<span class=sd>        Raises:</span>
<span class=sd>            Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Response: Returns to the run index page (list of pipeline runs).</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in run fetch: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># make sure that only the run creator or an admin can request the run</span>
        <span class=c1># to be processed.</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># check that it&#39;s not already running or queued</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;RUN&quot;</span><span class=p>,</span> <span class=s2>&quot;QUE&quot;</span><span class=p>,</span> <span class=s2>&quot;RES&quot;</span><span class=p>]:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is already running, queued or restoring. &#39;</span>
                <span class=s1>&#39;It cannot be deleted at this time.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>async_task</span><span class=p>(</span>
                <span class=s1>&#39;django.core.management.call_command&#39;</span><span class=p>,</span>
                <span class=s1>&#39;clearpiperun&#39;</span><span class=p>,</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
                <span class=n>remove_all</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=p>)</span>

            <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;Delete &lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully requested!&lt;br&gt;&lt;br&gt;&#39;</span>
                <span class=s1>&#39; Refresh the Pipeline Runs page for the deletion to take effect.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in deleting run: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
            <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_index&#39;</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>genarrow</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=p>)</span> <span class=o>-&gt;</span><span class=n>HttpResponseRedirect</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Launches the create arrow files process for a pipeline run using</span>
<span class=sd>        a Django Q cluster. Includes a check on ownership or admin status of</span>
<span class=sd>        the user to make sure the creation is allowed.</span>

<span class=sd>        Args:</span>
<span class=sd>            request: Django REST Framework request object.</span>
<span class=sd>            pk: Run object primary key. Defaults to None.</span>

<span class=sd>        Raises:</span>
<span class=sd>            Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Response: Returns to the orignal request page (the pipeline run</span>
<span class=sd>                detail).</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in run fetch: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># make sure that only the run creator or an admin can request the run</span>
        <span class=c1># to be processed.</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=c1># check that it&#39;s not already running or queued</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>!=</span> <span class=s2>&quot;END&quot;</span><span class=p>:</span>
            <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> has not completed successfully.&#39;</span>
                <span class=s1>&#39; The arrow files can only be generated after the run is&#39;</span>
                <span class=s1>&#39; successful.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>overwrite_flag</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;arrowOverwrite&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=kc>False</span>

            <span class=n>async_task</span><span class=p>(</span>
                <span class=s1>&#39;django.core.management.call_command&#39;</span><span class=p>,</span>
                <span class=s1>&#39;createmeasarrow&#39;</span><span class=p>,</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
                <span class=n>overwrite</span><span class=o>=</span><span class=n>overwrite_flag</span><span class=p>,</span>
                <span class=n>verbosity</span><span class=o>=</span><span class=mi>3</span>
            <span class=p>)</span>

            <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;Generate the arrow files for &lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully requested!&lt;br&gt;&lt;br&gt;&#39;</span>
                <span class=s1>&#39; Refresh the page and check the generate arrow log output for the status of the process.&#39;</span>
            <span class=p>)</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=n>msg</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
                <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in deleting run: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
            <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_detail&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>p_run</span><span class=o>.</span><span class=n>id</span><span class=p>])</span>
        <span class=p>)</span>
</code></pre></div> </td></tr></table> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.RunViewSet.delete class="doc doc-heading"> <code class="highlight language-python"><span class=n>delete</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#vast_pipeline.views.RunViewSet.delete class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Launches the remove pipeline run using a Django Q cluster. Includes a check on ownership or admin status of the user to make sure deletion is allowed.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>pk</code></td> <td> <code>int</code> </td> <td><p>Run object primary key. Defaults to None.</p></td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if a Source with the given <code>pk</code> cannot be found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Response</code></td> <td> <code><span title="django.http.HttpResponseRedirect">HttpResponseRedirect</span></code> </td> <td><p>Returns to the run index page (list of pipeline runs).</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
<span class=k>def</span> <span class=nf>delete</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HttpResponseRedirect</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Launches the remove pipeline run using a Django Q cluster. Includes a</span>
<span class=sd>    check on ownership or admin status of the user to make sure</span>
<span class=sd>    deletion is allowed.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST Framework request object.</span>
<span class=sd>        pk (int, optional): Run object primary key. Defaults to None.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Response: Returns to the run index page (list of pipeline runs).</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in run fetch: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># make sure that only the run creator or an admin can request the run</span>
    <span class=c1># to be processed.</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># check that it&#39;s not already running or queued</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;RUN&quot;</span><span class=p>,</span> <span class=s2>&quot;QUE&quot;</span><span class=p>,</span> <span class=s2>&quot;RES&quot;</span><span class=p>]:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is already running, queued or restoring. &#39;</span>
            <span class=s1>&#39;It cannot be deleted at this time.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>async_task</span><span class=p>(</span>
            <span class=s1>&#39;django.core.management.call_command&#39;</span><span class=p>,</span>
            <span class=s1>&#39;clearpiperun&#39;</span><span class=p>,</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
            <span class=n>remove_all</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=p>)</span>

        <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;Delete &lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully requested!&lt;br&gt;&lt;br&gt;&#39;</span>
            <span class=s1>&#39; Refresh the Pipeline Runs page for the deletion to take effect.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in deleting run: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
        <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_index&#39;</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.RunViewSet.genarrow class="doc doc-heading"> <code class="highlight language-python"><span class=n>genarrow</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#vast_pipeline.views.RunViewSet.genarrow class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Launches the create arrow files process for a pipeline run using a Django Q cluster. Includes a check on ownership or admin status of the user to make sure the creation is allowed.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>pk</code></td> <td> <code><span title="typing.Optional">Optional</span>[int]</code> </td> <td><p>Run object primary key. Defaults to None.</p></td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if a Source with the given <code>pk</code> cannot be found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Response</code></td> <td> <code><span title="django.http.HttpResponseRedirect">HttpResponseRedirect</span></code> </td> <td><p>Returns to the orignal request page (the pipeline run detail).</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
<span class=k>def</span> <span class=nf>genarrow</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span><span class=n>HttpResponseRedirect</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Launches the create arrow files process for a pipeline run using</span>
<span class=sd>    a Django Q cluster. Includes a check on ownership or admin status of</span>
<span class=sd>    the user to make sure the creation is allowed.</span>

<span class=sd>    Args:</span>
<span class=sd>        request: Django REST Framework request object.</span>
<span class=sd>        pk: Run object primary key. Defaults to None.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Response: Returns to the orignal request page (the pipeline run</span>
<span class=sd>            detail).</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in run fetch: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># make sure that only the run creator or an admin can request the run</span>
    <span class=c1># to be processed.</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># check that it&#39;s not already running or queued</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>!=</span> <span class=s2>&quot;END&quot;</span><span class=p>:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> has not completed successfully.&#39;</span>
            <span class=s1>&#39; The arrow files can only be generated after the run is&#39;</span>
            <span class=s1>&#39; successful.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>overwrite_flag</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;arrowOverwrite&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=kc>False</span>

        <span class=n>async_task</span><span class=p>(</span>
            <span class=s1>&#39;django.core.management.call_command&#39;</span><span class=p>,</span>
            <span class=s1>&#39;createmeasarrow&#39;</span><span class=p>,</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
            <span class=n>overwrite</span><span class=o>=</span><span class=n>overwrite_flag</span><span class=p>,</span>
            <span class=n>verbosity</span><span class=o>=</span><span class=mi>3</span>
        <span class=p>)</span>

        <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;Generate the arrow files for &lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully requested!&lt;br&gt;&lt;br&gt;&#39;</span>
            <span class=s1>&#39; Refresh the page and check the generate arrow log output for the status of the process.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in deleting run: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
        <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_detail&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>p_run</span><span class=o>.</span><span class=n>id</span><span class=p>])</span>
    <span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.RunViewSet.restore class="doc doc-heading"> <code class="highlight language-python"><span class=n>restore</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#vast_pipeline.views.RunViewSet.restore class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Launches a restore pipeline run using a Django Q cluster. Includes a check on ownership or admin status of the user to make sure processing is allowed.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>pk</code></td> <td> <code><span title="typing.Optional">Optional</span>[int]</code> </td> <td><p>Run object primary key. Defaults to None.</p></td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if a Source with the given <code>pk</code> cannot be found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Response</code></td> <td> <code><span title="django.http.HttpResponseRedirect">HttpResponseRedirect</span></code> </td> <td><p>Returns to the orignal request page (the pipeline run detail).</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
<span class=k>def</span> <span class=nf>restore</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HttpResponseRedirect</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Launches a restore pipeline run using a Django Q cluster. Includes a</span>
<span class=sd>    check on ownership or admin status of the user to make sure</span>
<span class=sd>    processing is allowed.</span>

<span class=sd>    Args:</span>
<span class=sd>        request: Django REST Framework request object.</span>
<span class=sd>        pk: Run object primary key. Defaults to None.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Response: Returns to the orignal request page (the pipeline run</span>
<span class=sd>            detail).</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in run fetch: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># make sure that only the run creator or an admin can request the run</span>
    <span class=c1># to be processed.</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># check that it&#39;s not already running or queued</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;RUN&quot;</span><span class=p>,</span> <span class=s2>&quot;QUE&quot;</span><span class=p>,</span> <span class=s2>&quot;RES&quot;</span><span class=p>,</span> <span class=s2>&quot;INI&quot;</span><span class=p>]:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is already running, queued, restoring or is &#39;</span>
            <span class=s1>&#39;only initialised. It cannot be restored at this time.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>if</span> <span class=n>Run</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>check_max_runs</span><span class=p>(</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=p>):</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
            <span class=s1>&#39;The maximum number of simultaneous pipeline runs has been&#39;</span>
            <span class=sa>f</span><span class=s1>&#39; reached (</span><span class=si>{</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=si>}</span><span class=s1>)! Please try again&#39;</span>
            <span class=s1>&#39; when other jobs have finished.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=n>prev_status</span> <span class=o>=</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>debug_flag</span> <span class=o>=</span> <span class=mi>3</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;restoreDebug&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=mi>1</span>

        <span class=n>async_task</span><span class=p>(</span>
            <span class=s1>&#39;django.core.management.call_command&#39;</span><span class=p>,</span>
            <span class=s1>&#39;restorepiperun&#39;</span><span class=p>,</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
            <span class=n>no_confirm</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
            <span class=n>verbosity</span><span class=o>=</span><span class=n>debug_flag</span>
        <span class=p>)</span>

        <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;Restore &lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully sent to the queue!&lt;br&gt;&lt;br&gt;Refresh the&#39;</span>
            <span class=s1>&#39; page to check the status.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in restoring run: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
        <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_detail&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>p_run</span><span class=o>.</span><span class=n>id</span><span class=p>])</span>
    <span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.RunViewSet.run class="doc doc-heading"> <code class="highlight language-python"><span class=n>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#vast_pipeline.views.RunViewSet.run class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Launches a pipeline run using a Django Q cluster. Includes a check on ownership or admin stataus of the user to make sure processing is allowed.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>pk</code></td> <td> <code><span title="typing.Optional">Optional</span>[int]</code> </td> <td><p>Run object primary key. Defaults to None.</p></td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if a Source with the given <code>pk</code> cannot be found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Response</code></td> <td> <code><span title="django.http.HttpResponseRedirect">HttpResponseRedirect</span></code> </td> <td><p>Returns to the orignal request page (the pipeline run detail).</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;post&#39;</span><span class=p>])</span>
<span class=k>def</span> <span class=nf>run</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>HttpResponseRedirect</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Launches a pipeline run using a Django Q cluster. Includes a check</span>
<span class=sd>    on ownership or admin stataus of the user to make sure processing</span>
<span class=sd>    is allowed.</span>

<span class=sd>    Args:</span>
<span class=sd>        request: Django REST Framework request object.</span>
<span class=sd>        pk: Run object primary key. Defaults to None.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Response: Returns to the orignal request page (the pipeline run</span>
<span class=sd>            detail).</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>pk</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=s1>&#39;Error in config write: Run pk parameter null or not passed&#39;</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>p_run</span> <span class=o>=</span> <span class=n>get_object_or_404</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queryset</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in config write: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># make sure that only the run creator or an admin can request the run</span>
    <span class=c1># to be processed.</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>user</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>is_staff</span><span class=p>:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;You do not have permission to process this pipeline run!&#39;</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=c1># check that it&#39;s not already running or queued</span>
    <span class=k>if</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;RUN&quot;</span><span class=p>,</span> <span class=s2>&quot;QUE&quot;</span><span class=p>,</span> <span class=s2>&quot;RES&quot;</span><span class=p>]:</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is already running, queued or restoring.&#39;</span>
            <span class=s1>&#39; Please wait for the run to complete before trying to&#39;</span>
            <span class=s1>&#39; submit again.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>if</span> <span class=n>Run</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>check_max_runs</span><span class=p>(</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=p>):</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=p>(</span>
            <span class=s1>&#39;The maximum number of simultaneous pipeline runs has been&#39;</span>
            <span class=sa>f</span><span class=s1>&#39; reached (</span><span class=si>{</span><span class=n>settings</span><span class=o>.</span><span class=n>MAX_PIPELINE_RUNS</span><span class=si>}</span><span class=s1>)! Please try again&#39;</span>
            <span class=s1>&#39; when other jobs have finished.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=n>prev_status</span> <span class=o>=</span> <span class=n>p_run</span><span class=o>.</span><span class=n>status</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;QUE&#39;</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>

        <span class=n>debug_flag</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;debug&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=kc>False</span>
        <span class=n>full_rerun</span> <span class=o>=</span> <span class=kc>True</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;fullReRun&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=k>else</span> <span class=kc>False</span>

        <span class=n>async_task</span><span class=p>(</span>
            <span class=s1>&#39;vast_pipeline.management.commands.runpipeline.run_pipe&#39;</span><span class=p>,</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>p_run</span><span class=o>.</span><span class=n>path</span><span class=p>,</span> <span class=n>p_run</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=n>debug_flag</span><span class=p>,</span>
            <span class=n>task_name</span><span class=o>=</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>ack_failure</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=p>,</span>
            <span class=n>full_rerun</span><span class=o>=</span><span class=n>full_rerun</span><span class=p>,</span> <span class=n>prev_ui_status</span><span class=o>=</span><span class=n>prev_status</span>
        <span class=p>)</span>
        <span class=n>msg</span> <span class=o>=</span> <span class=n>mark_safe</span><span class=p>(</span>
            <span class=sa>f</span><span class=s1>&#39;&lt;b&gt;</span><span class=si>{</span><span class=n>p_run</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1>&lt;/b&gt; successfully sent to the queue!&lt;br&gt;&lt;br&gt;Refresh the&#39;</span>
            <span class=s1>&#39; page to check the status.&#39;</span>
        <span class=p>)</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>success</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=n>msg</span>
        <span class=p>)</span>
    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>with</span> <span class=n>transaction</span><span class=o>.</span><span class=n>atomic</span><span class=p>():</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=s1>&#39;ERR&#39;</span>
            <span class=n>p_run</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;Error in running pipeline: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>META</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;HTTP_REFERER&#39;</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>HttpResponseRedirect</span><span class=p>(</span>
        <span class=n>reverse</span><span class=p>(</span><span class=s1>&#39;vast_pipeline:run_detail&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>[</span><span class=n>p_run</span><span class=o>.</span><span class=n>id</span><span class=p>])</span>
    <span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=vast_pipeline.views.SourcePlotsSet class="doc doc-heading"> <code>SourcePlotsSet</code> <a href=#vast_pipeline.views.SourcePlotsSet class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="rest_framework.viewsets.ViewSet">ViewSet</span></code></p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2604</span>
<span class=normal>2605</span>
<span class=normal>2606</span>
<span class=normal>2607</span>
<span class=normal>2608</span>
<span class=normal>2609</span>
<span class=normal>2610</span>
<span class=normal>2611</span>
<span class=normal>2612</span>
<span class=normal>2613</span>
<span class=normal>2614</span>
<span class=normal>2615</span>
<span class=normal>2616</span>
<span class=normal>2617</span>
<span class=normal>2618</span>
<span class=normal>2619</span>
<span class=normal>2620</span>
<span class=normal>2621</span>
<span class=normal>2622</span>
<span class=normal>2623</span>
<span class=normal>2624</span>
<span class=normal>2625</span>
<span class=normal>2626</span>
<span class=normal>2627</span>
<span class=normal>2628</span>
<span class=normal>2629</span>
<span class=normal>2630</span>
<span class=normal>2631</span>
<span class=normal>2632</span>
<span class=normal>2633</span>
<span class=normal>2634</span>
<span class=normal>2635</span>
<span class=normal>2636</span>
<span class=normal>2637</span>
<span class=normal>2638</span>
<span class=normal>2639</span>
<span class=normal>2640</span>
<span class=normal>2641</span>
<span class=normal>2642</span>
<span class=normal>2643</span>
<span class=normal>2644</span>
<span class=normal>2645</span>
<span class=normal>2646</span>
<span class=normal>2647</span>
<span class=normal>2648</span>
<span class=normal>2649</span>
<span class=normal>2650</span>
<span class=normal>2651</span>
<span class=normal>2652</span>
<span class=normal>2653</span>
<span class=normal>2654</span>
<span class=normal>2655</span>
<span class=normal>2656</span>
<span class=normal>2657</span>
<span class=normal>2658</span>
<span class=normal>2659</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>SourcePlotsSet</span><span class=p>(</span><span class=n>ViewSet</span><span class=p>):</span>
    <span class=n>authentication_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>SessionAuthentication</span><span class=p>,</span> <span class=n>BasicAuthentication</span><span class=p>]</span>
    <span class=n>permission_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>IsAuthenticated</span><span class=p>]</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>def</span> <span class=nf>lightcurve</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;Create lightcurve and 2-epoch metric graph plots for a source.</span>

<span class=sd>        Args:</span>
<span class=sd>            request (Request): Django REST Framework request object.</span>
<span class=sd>            pk (int, optional): Source object primary key. Defaults to None.</span>

<span class=sd>        Raises:</span>
<span class=sd>            Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Response: Django REST Framework response object containing the Bokeh plot in</span>
<span class=sd>                JSON format to be embedded in the HTML template.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>source</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
        <span class=k>except</span> <span class=n>Source</span><span class=o>.</span><span class=n>DoesNotExist</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>Http404</span>
        <span class=c1># TODO raster plots version for Slack posts</span>
        <span class=n>use_peak_flux</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;peak_flux&quot;</span><span class=p>,</span> <span class=s2>&quot;true&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span>
        <span class=n>plot_document</span> <span class=o>=</span> <span class=n>plot_lightcurve</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>use_peak_flux</span><span class=o>=</span><span class=n>use_peak_flux</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>json_item</span><span class=p>(</span><span class=n>plot_document</span><span class=p>))</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=k>def</span> <span class=nf>etavplot</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;Create the eta-V plot.</span>

<span class=sd>        Args:</span>
<span class=sd>            request (Request): Django REST Framework request object.</span>

<span class=sd>        Raises:</span>
<span class=sd>            Http404: if no sources are found.</span>

<span class=sd>        Returns:</span>
<span class=sd>            Response: Django REST Framework response object containing the Bokeh plot in</span>
<span class=sd>                JSON format to be embedded in the HTML template.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>source_query_result_id_list</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;source_query_result_ids&quot;</span><span class=p>,</span> <span class=p>[])</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>source</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk__in</span><span class=o>=</span><span class=n>source_query_result_id_list</span><span class=p>)</span>
        <span class=k>except</span> <span class=n>Source</span><span class=o>.</span><span class=n>DoesNotExist</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>Http404</span>
        <span class=c1># TODO raster plots version for Slack posts</span>
        <span class=n>use_peak_flux</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;peak_flux&quot;</span><span class=p>,</span> <span class=s2>&quot;true&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span>

        <span class=n>eta_sigma</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;eta_sigma&quot;</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>))</span>
        <span class=n>v_sigma</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;v_sigma&quot;</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>))</span>

        <span class=n>plot_document</span> <span class=o>=</span> <span class=n>plot_eta_v_bokeh</span><span class=p>(</span>
            <span class=n>source</span><span class=p>,</span> <span class=n>eta_sigma</span><span class=o>=</span><span class=n>eta_sigma</span><span class=p>,</span> <span class=n>v_sigma</span><span class=o>=</span><span class=n>v_sigma</span><span class=p>,</span> <span class=n>use_peak_flux</span><span class=o>=</span><span class=n>use_peak_flux</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>json_item</span><span class=p>(</span><span class=n>plot_document</span><span class=p>))</span>
</code></pre></div> </td></tr></table> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.SourcePlotsSet.etavplot class="doc doc-heading"> <code class="highlight language-python"><span class=n>etavplot</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>)</span></code> <a href=#vast_pipeline.views.SourcePlotsSet.etavplot class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Create the eta-V plot.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if no sources are found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Response</code></td> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>Django REST Framework response object containing the Bokeh plot in JSON format to be embedded in the HTML template.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2632</span>
<span class=normal>2633</span>
<span class=normal>2634</span>
<span class=normal>2635</span>
<span class=normal>2636</span>
<span class=normal>2637</span>
<span class=normal>2638</span>
<span class=normal>2639</span>
<span class=normal>2640</span>
<span class=normal>2641</span>
<span class=normal>2642</span>
<span class=normal>2643</span>
<span class=normal>2644</span>
<span class=normal>2645</span>
<span class=normal>2646</span>
<span class=normal>2647</span>
<span class=normal>2648</span>
<span class=normal>2649</span>
<span class=normal>2650</span>
<span class=normal>2651</span>
<span class=normal>2652</span>
<span class=normal>2653</span>
<span class=normal>2654</span>
<span class=normal>2655</span>
<span class=normal>2656</span>
<span class=normal>2657</span>
<span class=normal>2658</span>
<span class=normal>2659</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>etavplot</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;Create the eta-V plot.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST Framework request object.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if no sources are found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Response: Django REST Framework response object containing the Bokeh plot in</span>
<span class=sd>            JSON format to be embedded in the HTML template.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>source_query_result_id_list</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;source_query_result_ids&quot;</span><span class=p>,</span> <span class=p>[])</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>source</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>pk__in</span><span class=o>=</span><span class=n>source_query_result_id_list</span><span class=p>)</span>
    <span class=k>except</span> <span class=n>Source</span><span class=o>.</span><span class=n>DoesNotExist</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>Http404</span>
    <span class=c1># TODO raster plots version for Slack posts</span>
    <span class=n>use_peak_flux</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;peak_flux&quot;</span><span class=p>,</span> <span class=s2>&quot;true&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span>

    <span class=n>eta_sigma</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;eta_sigma&quot;</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>))</span>
    <span class=n>v_sigma</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;v_sigma&quot;</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>))</span>

    <span class=n>plot_document</span> <span class=o>=</span> <span class=n>plot_eta_v_bokeh</span><span class=p>(</span>
        <span class=n>source</span><span class=p>,</span> <span class=n>eta_sigma</span><span class=o>=</span><span class=n>eta_sigma</span><span class=p>,</span> <span class=n>v_sigma</span><span class=o>=</span><span class=n>v_sigma</span><span class=p>,</span> <span class=n>use_peak_flux</span><span class=o>=</span><span class=n>use_peak_flux</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>json_item</span><span class=p>(</span><span class=n>plot_document</span><span class=p>))</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.SourcePlotsSet.lightcurve class="doc doc-heading"> <code class="highlight language-python"><span class=n>lightcurve</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#vast_pipeline.views.SourcePlotsSet.lightcurve class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Create lightcurve and 2-epoch metric graph plots for a source.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>pk</code></td> <td> <code>int</code> </td> <td><p>Source object primary key. Defaults to None.</p></td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if a Source with the given <code>pk</code> cannot be found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>Response</code></td> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>Django REST Framework response object containing the Bokeh plot in JSON format to be embedded in the HTML template.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2608</span>
<span class=normal>2609</span>
<span class=normal>2610</span>
<span class=normal>2611</span>
<span class=normal>2612</span>
<span class=normal>2613</span>
<span class=normal>2614</span>
<span class=normal>2615</span>
<span class=normal>2616</span>
<span class=normal>2617</span>
<span class=normal>2618</span>
<span class=normal>2619</span>
<span class=normal>2620</span>
<span class=normal>2621</span>
<span class=normal>2622</span>
<span class=normal>2623</span>
<span class=normal>2624</span>
<span class=normal>2625</span>
<span class=normal>2626</span>
<span class=normal>2627</span>
<span class=normal>2628</span>
<span class=normal>2629</span>
<span class=normal>2630</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>lightcurve</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;Create lightcurve and 2-epoch metric graph plots for a source.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST Framework request object.</span>
<span class=sd>        pk (int, optional): Source object primary key. Defaults to None.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Response: Django REST Framework response object containing the Bokeh plot in</span>
<span class=sd>            JSON format to be embedded in the HTML template.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>source</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
    <span class=k>except</span> <span class=n>Source</span><span class=o>.</span><span class=n>DoesNotExist</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>Http404</span>
    <span class=c1># TODO raster plots version for Slack posts</span>
    <span class=n>use_peak_flux</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;peak_flux&quot;</span><span class=p>,</span> <span class=s2>&quot;true&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&quot;true&quot;</span>
    <span class=n>plot_document</span> <span class=o>=</span> <span class=n>plot_lightcurve</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>use_peak_flux</span><span class=o>=</span><span class=n>use_peak_flux</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>json_item</span><span class=p>(</span><span class=n>plot_document</span><span class=p>))</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=vast_pipeline.views.SourceViewSet class="doc doc-heading"> <code>SourceViewSet</code> <a href=#vast_pipeline.views.SourceViewSet class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="rest_framework.viewsets.ModelViewSet">ModelViewSet</span></code></p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span>
<span class=normal>1341</span>
<span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span>
<span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span>
<span class=normal>1387</span>
<span class=normal>1388</span>
<span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span>
<span class=normal>1406</span>
<span class=normal>1407</span>
<span class=normal>1408</span>
<span class=normal>1409</span>
<span class=normal>1410</span>
<span class=normal>1411</span>
<span class=normal>1412</span>
<span class=normal>1413</span>
<span class=normal>1414</span>
<span class=normal>1415</span>
<span class=normal>1416</span>
<span class=normal>1417</span>
<span class=normal>1418</span>
<span class=normal>1419</span>
<span class=normal>1420</span>
<span class=normal>1421</span>
<span class=normal>1422</span>
<span class=normal>1423</span>
<span class=normal>1424</span>
<span class=normal>1425</span>
<span class=normal>1426</span>
<span class=normal>1427</span>
<span class=normal>1428</span>
<span class=normal>1429</span>
<span class=normal>1430</span>
<span class=normal>1431</span>
<span class=normal>1432</span>
<span class=normal>1433</span>
<span class=normal>1434</span>
<span class=normal>1435</span>
<span class=normal>1436</span>
<span class=normal>1437</span>
<span class=normal>1438</span>
<span class=normal>1439</span>
<span class=normal>1440</span>
<span class=normal>1441</span>
<span class=normal>1442</span>
<span class=normal>1443</span>
<span class=normal>1444</span>
<span class=normal>1445</span>
<span class=normal>1446</span>
<span class=normal>1447</span>
<span class=normal>1448</span>
<span class=normal>1449</span>
<span class=normal>1450</span>
<span class=normal>1451</span>
<span class=normal>1452</span>
<span class=normal>1453</span>
<span class=normal>1454</span>
<span class=normal>1455</span>
<span class=normal>1456</span>
<span class=normal>1457</span>
<span class=normal>1458</span>
<span class=normal>1459</span>
<span class=normal>1460</span>
<span class=normal>1461</span>
<span class=normal>1462</span>
<span class=normal>1463</span>
<span class=normal>1464</span>
<span class=normal>1465</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>SourceViewSet</span><span class=p>(</span><span class=n>ModelViewSet</span><span class=p>):</span>
    <span class=n>authentication_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>SessionAuthentication</span><span class=p>,</span> <span class=n>BasicAuthentication</span><span class=p>]</span>
    <span class=n>permission_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>IsAuthenticated</span><span class=p>]</span>
    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>SourceSerializer</span>

    <span class=k>def</span> <span class=nf>get_queryset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>run__status</span><span class=o>=</span><span class=s1>&#39;END&#39;</span><span class=p>)</span>

        <span class=n>radius_conversions</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;arcsec&quot;</span><span class=p>:</span> <span class=mf>3600.</span><span class=p>,</span>
            <span class=s2>&quot;arcmin&quot;</span><span class=p>:</span> <span class=mf>60.</span><span class=p>,</span>
            <span class=s2>&quot;deg&quot;</span><span class=p>:</span> <span class=mf>1.</span>
        <span class=p>}</span>

        <span class=n>qry_dict</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>p_run</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;run&#39;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>p_run</span><span class=p>:</span>
            <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;run__name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>p_run</span>

        <span class=n>flux_qry_flds</span> <span class=o>=</span> <span class=p>[</span>
            <span class=s1>&#39;avg_flux_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;avg_flux_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;min_flux_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;max_flux_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;min_flux_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;max_flux_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;min_flux_peak_isl_ratio&#39;</span><span class=p>,</span>
            <span class=s1>&#39;min_flux_int_isl_ratio&#39;</span><span class=p>,</span>
            <span class=s1>&#39;v_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;v_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;eta_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;eta_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;vs_abs_significant_max_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;vs_abs_significant_max_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;m_abs_significant_max_int&#39;</span><span class=p>,</span>
            <span class=s1>&#39;m_abs_significant_max_peak&#39;</span><span class=p>,</span>
            <span class=s1>&#39;n_meas&#39;</span><span class=p>,</span>
            <span class=s1>&#39;n_meas_sel&#39;</span><span class=p>,</span>
            <span class=s1>&#39;n_meas_forced&#39;</span><span class=p>,</span>
            <span class=s1>&#39;n_rel&#39;</span><span class=p>,</span>
            <span class=s1>&#39;new_high_sigma&#39;</span><span class=p>,</span>
            <span class=s1>&#39;avg_compactness&#39;</span><span class=p>,</span>
            <span class=s1>&#39;min_snr&#39;</span><span class=p>,</span>
            <span class=s1>&#39;max_snr&#39;</span><span class=p>,</span>
            <span class=s1>&#39;n_neighbour_dist&#39;</span><span class=p>,</span>
            <span class=s1>&#39;source_selection&#39;</span><span class=p>,</span>
            <span class=s1>&#39;source_selection_type&#39;</span>
        <span class=p>]</span>

        <span class=n>neighbour_unit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;NeighbourUnit&#39;</span><span class=p>)</span>

        <span class=k>for</span> <span class=n>fld</span> <span class=ow>in</span> <span class=n>flux_qry_flds</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>limit</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;max&#39;</span><span class=p>,</span> <span class=s1>&#39;min&#39;</span><span class=p>]:</span>
                <span class=n>val</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>limit</span> <span class=o>+</span> <span class=s1>&#39;_&#39;</span> <span class=o>+</span> <span class=n>fld</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>val</span><span class=p>:</span>
                    <span class=n>ky</span> <span class=o>=</span> <span class=n>fld</span> <span class=o>+</span> <span class=s1>&#39;__lte&#39;</span> <span class=k>if</span> <span class=n>limit</span> <span class=o>==</span> <span class=s1>&#39;max&#39;</span> <span class=k>else</span> <span class=n>fld</span> <span class=o>+</span> <span class=s1>&#39;__gte&#39;</span>
                    <span class=k>if</span> <span class=n>fld</span> <span class=o>==</span> <span class=s1>&#39;n_neighbour_dist&#39;</span><span class=p>:</span>
                        <span class=n>val</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=o>/</span> <span class=n>radius_conversions</span><span class=p>[</span><span class=n>neighbour_unit</span><span class=p>]</span>
                    <span class=n>qry_dict</span><span class=p>[</span><span class=n>ky</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span>

        <span class=n>measurements</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;meas&#39;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>measurements</span><span class=p>:</span>
            <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;measurements&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>measurements</span>

        <span class=k>if</span> <span class=s1>&#39;source_selection&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>:</span>
            <span class=n>selection_type</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>[</span><span class=s1>&#39;source_selection_type&#39;</span><span class=p>]</span>
            <span class=n>selection</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>[</span><span class=s1>&#39;source_selection&#39;</span><span class=p>]</span>
                <span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot; &quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
                <span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;VAST&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>  <span class=c1># remove published source prefix if present</span>
                <span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;,&quot;</span><span class=p>)</span>
            <span class=p>)</span>
            <span class=k>if</span> <span class=n>selection_type</span> <span class=o>==</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span>
                <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;name__in&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>selection</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=n>selection</span> <span class=o>=</span> <span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>selection</span><span class=p>]</span>
                    <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;id__in&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>selection</span>
                <span class=k>except</span><span class=p>:</span>
                    <span class=c1># this avoids an error on the check if the user has</span>
                    <span class=c1># accidentally entered names with a &#39;id&#39; selection type.</span>
                    <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>

        <span class=k>if</span> <span class=s1>&#39;newsrc&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>:</span>
            <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;new&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=k>if</span> <span class=s1>&#39;no_siblings&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>:</span>
            <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;n_sibl&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>

        <span class=k>if</span> <span class=s1>&#39;tags_include&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>:</span>
            <span class=n>qry_dict</span><span class=p>[</span><span class=s1>&#39;tags&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>[</span><span class=s1>&#39;tags_include&#39;</span><span class=p>]</span>

        <span class=k>if</span> <span class=s1>&#39;tags_exclude&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>:</span>
            <span class=n>qs</span> <span class=o>=</span> <span class=n>qs</span><span class=o>.</span><span class=n>exclude</span><span class=p>(</span><span class=n>tags</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=p>[</span><span class=s1>&#39;tags_exclude&#39;</span><span class=p>])</span>

        <span class=k>if</span> <span class=n>qry_dict</span><span class=p>:</span>
            <span class=n>qs</span> <span class=o>=</span> <span class=n>qs</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=o>**</span><span class=n>qry_dict</span><span class=p>)</span>

        <span class=n>radius</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;radius&#39;</span><span class=p>)</span>
        <span class=n>radiusUnit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;radiusunit&#39;</span><span class=p>)</span>
        <span class=n>coordsys</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;coordsys&#39;</span><span class=p>)</span>
        <span class=n>coord_string</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;coord&#39;</span><span class=p>)</span>
        <span class=n>wavg_ra</span><span class=p>,</span> <span class=n>wavg_dec</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=kc>None</span>
        <span class=k>if</span> <span class=n>coord_string</span><span class=p>:</span>
            <span class=n>coord</span> <span class=o>=</span> <span class=n>parse_coord</span><span class=p>(</span><span class=n>coord_string</span><span class=p>,</span> <span class=n>coord_frame</span><span class=o>=</span><span class=n>coordsys</span><span class=p>)</span><span class=o>.</span><span class=n>transform_to</span><span class=p>(</span><span class=s2>&quot;icrs&quot;</span><span class=p>)</span>
            <span class=n>wavg_ra</span> <span class=o>=</span> <span class=n>coord</span><span class=o>.</span><span class=n>ra</span><span class=o>.</span><span class=n>deg</span>
            <span class=n>wavg_dec</span> <span class=o>=</span> <span class=n>coord</span><span class=o>.</span><span class=n>dec</span><span class=o>.</span><span class=n>deg</span>

        <span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>(</span><span class=n>wavg_ra</span><span class=p>,</span> <span class=n>wavg_dec</span><span class=p>,</span> <span class=n>radius</span><span class=p>):</span>
            <span class=n>radius</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>radius</span><span class=p>)</span> <span class=o>/</span> <span class=n>radius_conversions</span><span class=p>[</span><span class=n>radiusUnit</span><span class=p>]</span>
            <span class=n>qs</span> <span class=o>=</span> <span class=n>qs</span><span class=o>.</span><span class=n>cone_search</span><span class=p>(</span><span class=n>wavg_ra</span><span class=p>,</span> <span class=n>wavg_dec</span><span class=p>,</span> <span class=n>radius</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>qs</span>

    <span class=k>def</span> <span class=nf>list</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;Override the DRF ModelViewSet.list function to store the source ID order in the</span>
<span class=sd>        user session to retain the source order for source detail view next and previous</span>
<span class=sd>        button links. Then, call the original list function.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>queryset</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filter_queryset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>get_queryset</span><span class=p>())</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s2>&quot;source_query_result_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
            <span class=n>queryset</span><span class=o>.</span><span class=n>values_list</span><span class=p>(</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=n>flat</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>list</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>detail</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>])</span>
    <span class=k>def</span> <span class=nf>related</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>related__id</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
        <span class=n>qs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filter_queryset</span><span class=p>(</span><span class=n>qs</span><span class=p>)</span>
        <span class=n>page</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>paginate_queryset</span><span class=p>(</span><span class=n>qs</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>page</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>serializer</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_serializer</span><span class=p>(</span><span class=n>page</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_paginated_response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>

        <span class=n>serializer</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_serializer</span><span class=p>(</span><span class=n>qs</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.SourceViewSet.list class="doc doc-heading"> <code class="highlight language-python"><span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> <a href=#vast_pipeline.views.SourceViewSet.list class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Override the DRF ModelViewSet.list function to store the source ID order in the user session to retain the source order for source detail view next and previous button links. Then, call the original list function.</p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1444</span>
<span class=normal>1445</span>
<span class=normal>1446</span>
<span class=normal>1447</span>
<span class=normal>1448</span>
<span class=normal>1449</span>
<span class=normal>1450</span>
<span class=normal>1451</span>
<span class=normal>1452</span>
<span class=normal>1453</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>list</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Override the DRF ModelViewSet.list function to store the source ID order in the</span>
<span class=sd>    user session to retain the source order for source detail view next and previous</span>
<span class=sd>    button links. Then, call the original list function.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>queryset</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filter_queryset</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>get_queryset</span><span class=p>())</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s2>&quot;source_query_result_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span>
        <span class=n>queryset</span><span class=o>.</span><span class=n>values_list</span><span class=p>(</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=n>flat</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>list</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=vast_pipeline.views.UtilitiesSet class="doc doc-heading"> <code>UtilitiesSet</code> <a href=#vast_pipeline.views.UtilitiesSet class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title="rest_framework.viewsets.ViewSet">ViewSet</span></code></p> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2475</span>
<span class=normal>2476</span>
<span class=normal>2477</span>
<span class=normal>2478</span>
<span class=normal>2479</span>
<span class=normal>2480</span>
<span class=normal>2481</span>
<span class=normal>2482</span>
<span class=normal>2483</span>
<span class=normal>2484</span>
<span class=normal>2485</span>
<span class=normal>2486</span>
<span class=normal>2487</span>
<span class=normal>2488</span>
<span class=normal>2489</span>
<span class=normal>2490</span>
<span class=normal>2491</span>
<span class=normal>2492</span>
<span class=normal>2493</span>
<span class=normal>2494</span>
<span class=normal>2495</span>
<span class=normal>2496</span>
<span class=normal>2497</span>
<span class=normal>2498</span>
<span class=normal>2499</span>
<span class=normal>2500</span>
<span class=normal>2501</span>
<span class=normal>2502</span>
<span class=normal>2503</span>
<span class=normal>2504</span>
<span class=normal>2505</span>
<span class=normal>2506</span>
<span class=normal>2507</span>
<span class=normal>2508</span>
<span class=normal>2509</span>
<span class=normal>2510</span>
<span class=normal>2511</span>
<span class=normal>2512</span>
<span class=normal>2513</span>
<span class=normal>2514</span>
<span class=normal>2515</span>
<span class=normal>2516</span>
<span class=normal>2517</span>
<span class=normal>2518</span>
<span class=normal>2519</span>
<span class=normal>2520</span>
<span class=normal>2521</span>
<span class=normal>2522</span>
<span class=normal>2523</span>
<span class=normal>2524</span>
<span class=normal>2525</span>
<span class=normal>2526</span>
<span class=normal>2527</span>
<span class=normal>2528</span>
<span class=normal>2529</span>
<span class=normal>2530</span>
<span class=normal>2531</span>
<span class=normal>2532</span>
<span class=normal>2533</span>
<span class=normal>2534</span>
<span class=normal>2535</span>
<span class=normal>2536</span>
<span class=normal>2537</span>
<span class=normal>2538</span>
<span class=normal>2539</span>
<span class=normal>2540</span>
<span class=normal>2541</span>
<span class=normal>2542</span>
<span class=normal>2543</span>
<span class=normal>2544</span>
<span class=normal>2545</span>
<span class=normal>2546</span>
<span class=normal>2547</span>
<span class=normal>2548</span>
<span class=normal>2549</span>
<span class=normal>2550</span>
<span class=normal>2551</span>
<span class=normal>2552</span>
<span class=normal>2553</span>
<span class=normal>2554</span>
<span class=normal>2555</span>
<span class=normal>2556</span>
<span class=normal>2557</span>
<span class=normal>2558</span>
<span class=normal>2559</span>
<span class=normal>2560</span>
<span class=normal>2561</span>
<span class=normal>2562</span>
<span class=normal>2563</span>
<span class=normal>2564</span>
<span class=normal>2565</span>
<span class=normal>2566</span>
<span class=normal>2567</span>
<span class=normal>2568</span>
<span class=normal>2569</span>
<span class=normal>2570</span>
<span class=normal>2571</span>
<span class=normal>2572</span>
<span class=normal>2573</span>
<span class=normal>2574</span>
<span class=normal>2575</span>
<span class=normal>2576</span>
<span class=normal>2577</span>
<span class=normal>2578</span>
<span class=normal>2579</span>
<span class=normal>2580</span>
<span class=normal>2581</span>
<span class=normal>2582</span>
<span class=normal>2583</span>
<span class=normal>2584</span>
<span class=normal>2585</span>
<span class=normal>2586</span>
<span class=normal>2587</span>
<span class=normal>2588</span>
<span class=normal>2589</span>
<span class=normal>2590</span>
<span class=normal>2591</span>
<span class=normal>2592</span>
<span class=normal>2593</span>
<span class=normal>2594</span>
<span class=normal>2595</span>
<span class=normal>2596</span>
<span class=normal>2597</span>
<span class=normal>2598</span>
<span class=normal>2599</span>
<span class=normal>2600</span>
<span class=normal>2601</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>UtilitiesSet</span><span class=p>(</span><span class=n>ViewSet</span><span class=p>):</span>
    <span class=n>authentication_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>SessionAuthentication</span><span class=p>,</span> <span class=n>BasicAuthentication</span><span class=p>]</span>
    <span class=n>permission_classes</span> <span class=o>=</span> <span class=p>[</span><span class=n>IsAuthenticated</span><span class=p>]</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span> <span class=nf>_external_search_error_handler</span><span class=p>(</span>
        <span class=n>external_query_func</span><span class=p>,</span>
        <span class=n>coord</span><span class=p>:</span> <span class=n>SkyCoord</span><span class=p>,</span>
        <span class=n>radius</span><span class=p>:</span> <span class=n>Angle</span><span class=p>,</span>
        <span class=n>service_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>results</span> <span class=o>=</span> <span class=n>external_query_func</span><span class=p>(</span><span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>)</span>
        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>HTTPError</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Unable to get </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2> query results.&quot;</span><span class=p>)</span>
            <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>return</span> <span class=n>results</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=k>def</span> <span class=nf>sesame_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;Query the Sesame name resolver service and return a coordinate.</span>

<span class=sd>        Args:</span>
<span class=sd>            request (Request): Django REST framework Request object with GET parameters:</span>
<span class=sd>                - object_name (str): Object name to query.</span>
<span class=sd>                - service (str, optional): Sesame service to query (all, simbad, ned, vizier).</span>
<span class=sd>                    Defaults to &quot;all&quot;.</span>

<span class=sd>        Returns:</span>
<span class=sd>            A Django REST framework Response. Will return JSON with status code:</span>
<span class=sd>                - 400 if the query params fail validation (i.e. if an invalid Sesame service</span>
<span class=sd>                    or no object name is provided) or if the name resolution fails. Error</span>
<span class=sd>                    messages are returned as an array of strings under the relevant query</span>
<span class=sd>                    parameter key. e.g. {&quot;object_name&quot;: [&quot;This field may not be blank.&quot;]}.</span>
<span class=sd>                - 200 if successful. Response data contains the passed in query parameters and</span>
<span class=sd>                    the resolved coordinate as a sexagesimal string with units hourangle, deg</span>
<span class=sd>                    under the key `coord`.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>object_name</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;object_name&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
        <span class=n>service</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;service&quot;</span><span class=p>,</span> <span class=s2>&quot;all&quot;</span><span class=p>)</span>

        <span class=n>serializer</span> <span class=o>=</span> <span class=n>SesameResultSerializer</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>object_name</span><span class=o>=</span><span class=n>object_name</span><span class=p>,</span> <span class=n>service</span><span class=o>=</span><span class=n>service</span><span class=p>))</span>
        <span class=n>serializer</span><span class=o>.</span><span class=n>is_valid</span><span class=p>(</span><span class=n>raise_exception</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=k>def</span> <span class=nf>coordinate_validator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;Validate a coordinate string.</span>

<span class=sd>        Args:</span>
<span class=sd>            request (Request): Django REST framework Request object with GET parameters:</span>
<span class=sd>                - coord (str): the coordinate string to validate.</span>
<span class=sd>                - frame (str): the frame for the given coordinate string e.g. icrs, galactic.</span>

<span class=sd>        Returns:</span>
<span class=sd>            A Django REST framework Response. Will return JSON with status code:</span>
<span class=sd>                - 400 if the query params fail validation, i.e. if a frame unknown to Astropy</span>
<span class=sd>                    is given, or the coordinate string fails to parse. Error messages are</span>
<span class=sd>                    returned as an array of strings under the relevant query parameter key.</span>
<span class=sd>                    e.g. {&quot;coord&quot;: [&quot;This field may not be blank.&quot;]}.</span>
<span class=sd>                - 200 if the coordinate string successfully validates. No other data is returned.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>coord_string</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;coord&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
        <span class=n>frame</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frame&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>

        <span class=n>serializer</span> <span class=o>=</span> <span class=n>CoordinateValidatorSerializer</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>coord</span><span class=o>=</span><span class=n>coord_string</span><span class=p>,</span> <span class=n>frame</span><span class=o>=</span><span class=n>frame</span><span class=p>))</span>
        <span class=n>serializer</span><span class=o>.</span><span class=n>is_valid</span><span class=p>(</span><span class=n>raise_exception</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>()</span>

    <span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;get&quot;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=k>def</span> <span class=nf>external_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
        <span class=sd>&quot;&quot;&quot;Perform a cone search with external providers (e.g. SIMBAD, NED, TNS) and</span>
<span class=sd>        return the combined results.</span>

<span class=sd>        Args:</span>
<span class=sd>            request (Request): Django REST Framework Request object get GET parameters:</span>
<span class=sd>                - coord (str): the coordinate string to validate. Interpreted by</span>
<span class=sd>                    `astropy.coordiantes.SkyCoord`.</span>
<span class=sd>                - radius (str): the cone search radius with unit, e.g. &quot;1arcmin&quot;.</span>
<span class=sd>                    Interpreted by `astropy.coordinates.Angle`</span>

<span class=sd>        Raises:</span>
<span class=sd>            serializers.ValidationError: if either the coordinate or radius parameters</span>
<span class=sd>                cannot be interpreted by `astropy.coordiantes.SkyCoord` or</span>
<span class=sd>                `astropy.coordinates.Angle`, respectively.</span>

<span class=sd>        Returns:</span>
<span class=sd>            A Django REST framework Response containing result records as a list</span>
<span class=sd>                under the data object key. Each record contains the properties:</span>
<span class=sd>                    - object_name: the name of the astronomical object.</span>
<span class=sd>                    - database: the source of the result, e.g. SIMBAD or NED.</span>
<span class=sd>                    - separation_arcsec: separation to the query coordinate in arcsec.</span>
<span class=sd>                    - otype: object type.</span>
<span class=sd>                    - otype_long: long form of the object type (only available for SIMBAD).</span>
<span class=sd>                    - ra_hms: RA coordinate string in &lt;HH&gt;h&lt;MM&gt;m&lt;SS.SSS&gt;s format.</span>
<span class=sd>                    - dec_dms: Dec coordinate string in Â±&lt;DD&gt;d&lt;MM&gt;m&lt;SS.SSS&gt;s format.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>coord_string</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;coord&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
        <span class=n>radius_string</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;radius&quot;</span><span class=p>,</span> <span class=s2>&quot;1arcmin&quot;</span><span class=p>)</span>

        <span class=c1># validate inputs</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>coord</span> <span class=o>=</span> <span class=n>parse_coord</span><span class=p>(</span><span class=n>coord_string</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>serializers</span><span class=o>.</span><span class=n>ValidationError</span><span class=p>({</span><span class=s2>&quot;coord&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>])})</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>radius</span> <span class=o>=</span> <span class=n>Angle</span><span class=p>(</span><span class=n>radius_string</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>serializers</span><span class=o>.</span><span class=n>ValidationError</span><span class=p>({</span><span class=s2>&quot;radius&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>])})</span>

        <span class=n>simbad_results</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_external_search_error_handler</span><span class=p>(</span>
            <span class=n>external_query</span><span class=o>.</span><span class=n>simbad</span><span class=p>,</span> <span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>,</span> <span class=s2>&quot;SIMBAD&quot;</span><span class=p>,</span> <span class=n>request</span>
        <span class=p>)</span>
        <span class=n>ned_results</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_external_search_error_handler</span><span class=p>(</span>
            <span class=n>external_query</span><span class=o>.</span><span class=n>ned</span><span class=p>,</span> <span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>,</span> <span class=s2>&quot;NED&quot;</span><span class=p>,</span> <span class=n>request</span>
        <span class=p>)</span>
        <span class=n>tns_results</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_external_search_error_handler</span><span class=p>(</span>
            <span class=n>external_query</span><span class=o>.</span><span class=n>tns</span><span class=p>,</span> <span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>,</span> <span class=s2>&quot;TNS&quot;</span><span class=p>,</span> <span class=n>request</span>
        <span class=p>)</span>

        <span class=n>results</span> <span class=o>=</span> <span class=n>simbad_results</span> <span class=o>+</span> <span class=n>ned_results</span> <span class=o>+</span> <span class=n>tns_results</span>
        <span class=n>serializer</span> <span class=o>=</span> <span class=n>ExternalSearchSerializer</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>results</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>serializer</span><span class=o>.</span><span class=n>is_valid</span><span class=p>(</span><span class=n>raise_exception</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.UtilitiesSet.coordinate_validator class="doc doc-heading"> <code class="highlight language-python"><span class=n>coordinate_validator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>)</span></code> <a href=#vast_pipeline.views.UtilitiesSet.coordinate_validator class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Validate a coordinate string.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST framework Request object with GET parameters: - coord (str): the coordinate string to validate. - frame (str): the frame for the given coordinate string e.g. icrs, galactic.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>A Django REST framework Response. Will return JSON with status code: - 400 if the query params fail validation, i.e. if a frame unknown to Astropy is given, or the coordinate string fails to parse. Error messages are returned as an array of strings under the relevant query parameter key. e.g. {"coord": ["This field may not be blank."]}. - 200 if the coordinate string successfully validates. No other data is returned.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2522</span>
<span class=normal>2523</span>
<span class=normal>2524</span>
<span class=normal>2525</span>
<span class=normal>2526</span>
<span class=normal>2527</span>
<span class=normal>2528</span>
<span class=normal>2529</span>
<span class=normal>2530</span>
<span class=normal>2531</span>
<span class=normal>2532</span>
<span class=normal>2533</span>
<span class=normal>2534</span>
<span class=normal>2535</span>
<span class=normal>2536</span>
<span class=normal>2537</span>
<span class=normal>2538</span>
<span class=normal>2539</span>
<span class=normal>2540</span>
<span class=normal>2541</span>
<span class=normal>2542</span>
<span class=normal>2543</span>
<span class=normal>2544</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>coordinate_validator</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;Validate a coordinate string.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST framework Request object with GET parameters:</span>
<span class=sd>            - coord (str): the coordinate string to validate.</span>
<span class=sd>            - frame (str): the frame for the given coordinate string e.g. icrs, galactic.</span>

<span class=sd>    Returns:</span>
<span class=sd>        A Django REST framework Response. Will return JSON with status code:</span>
<span class=sd>            - 400 if the query params fail validation, i.e. if a frame unknown to Astropy</span>
<span class=sd>                is given, or the coordinate string fails to parse. Error messages are</span>
<span class=sd>                returned as an array of strings under the relevant query parameter key.</span>
<span class=sd>                e.g. {&quot;coord&quot;: [&quot;This field may not be blank.&quot;]}.</span>
<span class=sd>            - 200 if the coordinate string successfully validates. No other data is returned.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>coord_string</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;coord&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=n>frame</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frame&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>

    <span class=n>serializer</span> <span class=o>=</span> <span class=n>CoordinateValidatorSerializer</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>coord</span><span class=o>=</span><span class=n>coord_string</span><span class=p>,</span> <span class=n>frame</span><span class=o>=</span><span class=n>frame</span><span class=p>))</span>
    <span class=n>serializer</span><span class=o>.</span><span class=n>is_valid</span><span class=p>(</span><span class=n>raise_exception</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>Response</span><span class=p>()</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.UtilitiesSet.external_search class="doc doc-heading"> <code class="highlight language-python"><span class=n>external_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>)</span></code> <a href=#vast_pipeline.views.UtilitiesSet.external_search class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Perform a cone search with external providers (e.g. SIMBAD, NED, TNS) and return the combined results.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework Request object get GET parameters: - coord (str): the coordinate string to validate. Interpreted by <code>astropy.coordiantes.SkyCoord</code>. - radius (str): the cone search radius with unit, e.g. "1arcmin". Interpreted by <code>astropy.coordinates.Angle</code></p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="rest_framework.serializers">serializers</span>.<span title="rest_framework.serializers.ValidationError">ValidationError</span></code> </td> <td><p>if either the coordinate or radius parameters cannot be interpreted by <code>astropy.coordiantes.SkyCoord</code> or <code>astropy.coordinates.Angle</code>, respectively.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>A Django REST framework Response containing result records as a list under the data object key. Each record contains the properties: - object_name: the name of the astronomical object. - database: the source of the result, e.g. SIMBAD or NED. - separation_arcsec: separation to the query coordinate in arcsec. - otype: object type. - otype_long: long form of the object type (only available for SIMBAD). - ra_hms: RA coordinate string in <hh>h<mm>m<ss.sss>s format. - dec_dms: Dec coordinate string in Â±<dd>d<mm>m<ss.sss>s format.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2546</span>
<span class=normal>2547</span>
<span class=normal>2548</span>
<span class=normal>2549</span>
<span class=normal>2550</span>
<span class=normal>2551</span>
<span class=normal>2552</span>
<span class=normal>2553</span>
<span class=normal>2554</span>
<span class=normal>2555</span>
<span class=normal>2556</span>
<span class=normal>2557</span>
<span class=normal>2558</span>
<span class=normal>2559</span>
<span class=normal>2560</span>
<span class=normal>2561</span>
<span class=normal>2562</span>
<span class=normal>2563</span>
<span class=normal>2564</span>
<span class=normal>2565</span>
<span class=normal>2566</span>
<span class=normal>2567</span>
<span class=normal>2568</span>
<span class=normal>2569</span>
<span class=normal>2570</span>
<span class=normal>2571</span>
<span class=normal>2572</span>
<span class=normal>2573</span>
<span class=normal>2574</span>
<span class=normal>2575</span>
<span class=normal>2576</span>
<span class=normal>2577</span>
<span class=normal>2578</span>
<span class=normal>2579</span>
<span class=normal>2580</span>
<span class=normal>2581</span>
<span class=normal>2582</span>
<span class=normal>2583</span>
<span class=normal>2584</span>
<span class=normal>2585</span>
<span class=normal>2586</span>
<span class=normal>2587</span>
<span class=normal>2588</span>
<span class=normal>2589</span>
<span class=normal>2590</span>
<span class=normal>2591</span>
<span class=normal>2592</span>
<span class=normal>2593</span>
<span class=normal>2594</span>
<span class=normal>2595</span>
<span class=normal>2596</span>
<span class=normal>2597</span>
<span class=normal>2598</span>
<span class=normal>2599</span>
<span class=normal>2600</span>
<span class=normal>2601</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;get&quot;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>external_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;Perform a cone search with external providers (e.g. SIMBAD, NED, TNS) and</span>
<span class=sd>    return the combined results.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST Framework Request object get GET parameters:</span>
<span class=sd>            - coord (str): the coordinate string to validate. Interpreted by</span>
<span class=sd>                `astropy.coordiantes.SkyCoord`.</span>
<span class=sd>            - radius (str): the cone search radius with unit, e.g. &quot;1arcmin&quot;.</span>
<span class=sd>                Interpreted by `astropy.coordinates.Angle`</span>

<span class=sd>    Raises:</span>
<span class=sd>        serializers.ValidationError: if either the coordinate or radius parameters</span>
<span class=sd>            cannot be interpreted by `astropy.coordiantes.SkyCoord` or</span>
<span class=sd>            `astropy.coordinates.Angle`, respectively.</span>

<span class=sd>    Returns:</span>
<span class=sd>        A Django REST framework Response containing result records as a list</span>
<span class=sd>            under the data object key. Each record contains the properties:</span>
<span class=sd>                - object_name: the name of the astronomical object.</span>
<span class=sd>                - database: the source of the result, e.g. SIMBAD or NED.</span>
<span class=sd>                - separation_arcsec: separation to the query coordinate in arcsec.</span>
<span class=sd>                - otype: object type.</span>
<span class=sd>                - otype_long: long form of the object type (only available for SIMBAD).</span>
<span class=sd>                - ra_hms: RA coordinate string in &lt;HH&gt;h&lt;MM&gt;m&lt;SS.SSS&gt;s format.</span>
<span class=sd>                - dec_dms: Dec coordinate string in Â±&lt;DD&gt;d&lt;MM&gt;m&lt;SS.SSS&gt;s format.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>coord_string</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;coord&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=n>radius_string</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;radius&quot;</span><span class=p>,</span> <span class=s2>&quot;1arcmin&quot;</span><span class=p>)</span>

    <span class=c1># validate inputs</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>coord</span> <span class=o>=</span> <span class=n>parse_coord</span><span class=p>(</span><span class=n>coord_string</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>serializers</span><span class=o>.</span><span class=n>ValidationError</span><span class=p>({</span><span class=s2>&quot;coord&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>])})</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>radius</span> <span class=o>=</span> <span class=n>Angle</span><span class=p>(</span><span class=n>radius_string</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>serializers</span><span class=o>.</span><span class=n>ValidationError</span><span class=p>({</span><span class=s2>&quot;radius&quot;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>])})</span>

    <span class=n>simbad_results</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_external_search_error_handler</span><span class=p>(</span>
        <span class=n>external_query</span><span class=o>.</span><span class=n>simbad</span><span class=p>,</span> <span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>,</span> <span class=s2>&quot;SIMBAD&quot;</span><span class=p>,</span> <span class=n>request</span>
    <span class=p>)</span>
    <span class=n>ned_results</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_external_search_error_handler</span><span class=p>(</span>
        <span class=n>external_query</span><span class=o>.</span><span class=n>ned</span><span class=p>,</span> <span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>,</span> <span class=s2>&quot;NED&quot;</span><span class=p>,</span> <span class=n>request</span>
    <span class=p>)</span>
    <span class=n>tns_results</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_external_search_error_handler</span><span class=p>(</span>
        <span class=n>external_query</span><span class=o>.</span><span class=n>tns</span><span class=p>,</span> <span class=n>coord</span><span class=p>,</span> <span class=n>radius</span><span class=p>,</span> <span class=s2>&quot;TNS&quot;</span><span class=p>,</span> <span class=n>request</span>
    <span class=p>)</span>

    <span class=n>results</span> <span class=o>=</span> <span class=n>simbad_results</span> <span class=o>+</span> <span class=n>ned_results</span> <span class=o>+</span> <span class=n>tns_results</span>
    <span class=n>serializer</span> <span class=o>=</span> <span class=n>ExternalSearchSerializer</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>results</span><span class=p>,</span> <span class=n>many</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>serializer</span><span class=o>.</span><span class=n>is_valid</span><span class=p>(</span><span class=n>raise_exception</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=vast_pipeline.views.UtilitiesSet.sesame_search class="doc doc-heading"> <code class="highlight language-python"><span class=n>sesame_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>)</span></code> <a href=#vast_pipeline.views.UtilitiesSet.sesame_search class=headerlink title="Permanent link">&para;</a></h3> <div class="doc doc-contents "> <p>Query the Sesame name resolver service and return a coordinate.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST framework Request object with GET parameters: - object_name (str): Object name to query. - service (str, optional): Sesame service to query (all, simbad, ned, vizier). Defaults to "all".</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>A Django REST framework Response. Will return JSON with status code: - 400 if the query params fail validation (i.e. if an invalid Sesame service or no object name is provided) or if the name resolution fails. Error messages are returned as an array of strings under the relevant query parameter key. e.g. {"object_name": ["This field may not be blank."]}. - 200 if successful. Response data contains the passed in query parameters and the resolved coordinate as a sexagesimal string with units hourangle, deg under the key <code>coord</code>.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2494</span>
<span class=normal>2495</span>
<span class=normal>2496</span>
<span class=normal>2497</span>
<span class=normal>2498</span>
<span class=normal>2499</span>
<span class=normal>2500</span>
<span class=normal>2501</span>
<span class=normal>2502</span>
<span class=normal>2503</span>
<span class=normal>2504</span>
<span class=normal>2505</span>
<span class=normal>2506</span>
<span class=normal>2507</span>
<span class=normal>2508</span>
<span class=normal>2509</span>
<span class=normal>2510</span>
<span class=normal>2511</span>
<span class=normal>2512</span>
<span class=normal>2513</span>
<span class=normal>2514</span>
<span class=normal>2515</span>
<span class=normal>2516</span>
<span class=normal>2517</span>
<span class=normal>2518</span>
<span class=normal>2519</span>
<span class=normal>2520</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@rest_framework</span><span class=o>.</span><span class=n>decorators</span><span class=o>.</span><span class=n>action</span><span class=p>(</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;get&#39;</span><span class=p>],</span> <span class=n>detail</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>sesame_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;Query the Sesame name resolver service and return a coordinate.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST framework Request object with GET parameters:</span>
<span class=sd>            - object_name (str): Object name to query.</span>
<span class=sd>            - service (str, optional): Sesame service to query (all, simbad, ned, vizier).</span>
<span class=sd>                Defaults to &quot;all&quot;.</span>

<span class=sd>    Returns:</span>
<span class=sd>        A Django REST framework Response. Will return JSON with status code:</span>
<span class=sd>            - 400 if the query params fail validation (i.e. if an invalid Sesame service</span>
<span class=sd>                or no object name is provided) or if the name resolution fails. Error</span>
<span class=sd>                messages are returned as an array of strings under the relevant query</span>
<span class=sd>                parameter key. e.g. {&quot;object_name&quot;: [&quot;This field may not be blank.&quot;]}.</span>
<span class=sd>            - 200 if successful. Response data contains the passed in query parameters and</span>
<span class=sd>                the resolved coordinate as a sexagesimal string with units hourangle, deg</span>
<span class=sd>                under the key `coord`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>object_name</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;object_name&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
    <span class=n>service</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>query_params</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;service&quot;</span><span class=p>,</span> <span class=s2>&quot;all&quot;</span><span class=p>)</span>

    <span class=n>serializer</span> <span class=o>=</span> <span class=n>SesameResultSerializer</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>object_name</span><span class=o>=</span><span class=n>object_name</span><span class=p>,</span> <span class=n>service</span><span class=o>=</span><span class=n>service</span><span class=p>))</span>
    <span class=n>serializer</span><span class=o>.</span><span class=n>is_valid</span><span class=p>(</span><span class=n>raise_exception</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>serializer</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=vast_pipeline.views.SourceEtaVPlot class="doc doc-heading"> <code class="highlight language-python"><span class=n>SourceEtaVPlot</span><span class=p>(</span><span class=n>request</span><span class=p>)</span></code> <a href=#vast_pipeline.views.SourceEtaVPlot class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>The view for the main eta-V plot page.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>The response for the main eta-V page.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1570</span>
<span class=normal>1571</span>
<span class=normal>1572</span>
<span class=normal>1573</span>
<span class=normal>1574</span>
<span class=normal>1575</span>
<span class=normal>1576</span>
<span class=normal>1577</span>
<span class=normal>1578</span>
<span class=normal>1579</span>
<span class=normal>1580</span>
<span class=normal>1581</span>
<span class=normal>1582</span>
<span class=normal>1583</span>
<span class=normal>1584</span>
<span class=normal>1585</span>
<span class=normal>1586</span>
<span class=normal>1587</span>
<span class=normal>1588</span>
<span class=normal>1589</span>
<span class=normal>1590</span>
<span class=normal>1591</span>
<span class=normal>1592</span>
<span class=normal>1593</span>
<span class=normal>1594</span>
<span class=normal>1595</span>
<span class=normal>1596</span>
<span class=normal>1597</span>
<span class=normal>1598</span>
<span class=normal>1599</span>
<span class=normal>1600</span>
<span class=normal>1601</span>
<span class=normal>1602</span>
<span class=normal>1603</span>
<span class=normal>1604</span>
<span class=normal>1605</span>
<span class=normal>1606</span>
<span class=normal>1607</span>
<span class=normal>1608</span>
<span class=normal>1609</span>
<span class=normal>1610</span>
<span class=normal>1611</span>
<span class=normal>1612</span>
<span class=normal>1613</span>
<span class=normal>1614</span>
<span class=normal>1615</span>
<span class=normal>1616</span>
<span class=normal>1617</span>
<span class=normal>1618</span>
<span class=normal>1619</span>
<span class=normal>1620</span>
<span class=normal>1621</span>
<span class=normal>1622</span>
<span class=normal>1623</span>
<span class=normal>1624</span>
<span class=normal>1625</span>
<span class=normal>1626</span>
<span class=normal>1627</span>
<span class=normal>1628</span>
<span class=normal>1629</span>
<span class=normal>1630</span>
<span class=normal>1631</span>
<span class=normal>1632</span>
<span class=normal>1633</span>
<span class=normal>1634</span>
<span class=normal>1635</span>
<span class=normal>1636</span>
<span class=normal>1637</span>
<span class=normal>1638</span>
<span class=normal>1639</span>
<span class=normal>1640</span>
<span class=normal>1641</span>
<span class=normal>1642</span>
<span class=normal>1643</span>
<span class=normal>1644</span>
<span class=normal>1645</span>
<span class=normal>1646</span>
<span class=normal>1647</span>
<span class=normal>1648</span>
<span class=normal>1649</span>
<span class=normal>1650</span>
<span class=normal>1651</span>
<span class=normal>1652</span>
<span class=normal>1653</span>
<span class=normal>1654</span>
<span class=normal>1655</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@login_required</span>
<span class=k>def</span> <span class=nf>SourceEtaVPlot</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;The view for the main eta-V plot page.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST Framework request object.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The response for the main eta-V page.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>min_sources</span> <span class=o>=</span> <span class=mi>50</span>

    <span class=n>source_query_result_id_list</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;source_query_result_ids&quot;</span><span class=p>,</span> <span class=p>[])</span>

    <span class=n>sources_query_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>source_query_result_id_list</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>sources_query_len</span> <span class=o>&lt;</span> <span class=n>min_sources</span><span class=p>:</span>
        <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
            <span class=n>request</span><span class=p>,</span>
            <span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;The query has returned only </span><span class=si>{</span><span class=n>sources_query_len</span><span class=si>}</span><span class=s1> sources.&#39;</span>
                <span class=sa>f</span><span class=s1>&#39; A minimum of </span><span class=si>{</span><span class=n>min_sources</span><span class=si>}</span><span class=s1> sources must be used to produce&#39;</span>
                <span class=s1>&#39; the plot.&#39;</span>
            <span class=p>)</span>
        <span class=p>)</span>

        <span class=n>plot_ok</span> <span class=o>=</span> <span class=mi>0</span>

    <span class=k>else</span><span class=p>:</span>
        <span class=n>sources</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
            <span class=n>id__in</span><span class=o>=</span><span class=n>source_query_result_id_list</span><span class=p>,</span>
            <span class=n>n_meas__gt</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
            <span class=n>eta_peak__gt</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
            <span class=n>eta_int__gt</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
            <span class=n>v_peak__gt</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
            <span class=n>v_int__gt</span><span class=o>=</span><span class=mi>0</span>
        <span class=p>)</span>

        <span class=n>new_sources_ids_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>sources</span><span class=o>.</span><span class=n>values_list</span><span class=p>(</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=n>flat</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>

        <span class=n>new_sources_query_len</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>new_sources_ids_list</span><span class=p>)</span>

        <span class=n>diff</span> <span class=o>=</span> <span class=n>sources_query_len</span> <span class=o>-</span> <span class=n>new_sources_query_len</span>

        <span class=k>if</span> <span class=n>diff</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=p>(</span>
                    <span class=sa>f</span><span class=s1>&#39;Removed </span><span class=si>{</span><span class=n>diff</span><span class=si>}</span><span class=s1> sources that either had&#39;</span>
                    <span class=s1>&#39; only one datapoint, or, an </span><span class=se>\u03B7</span><span class=s1> or V value of 0.&#39;</span>
                    <span class=s1>&#39; Change the query options to avoid these sources.&#39;</span>
                <span class=p>)</span>
            <span class=p>)</span>

            <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s2>&quot;source_query_result_ids&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_sources_ids_list</span>

        <span class=k>if</span> <span class=n>new_sources_query_len</span> <span class=o>&lt;</span> <span class=n>min_sources</span><span class=p>:</span>
            <span class=n>messages</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                <span class=n>request</span><span class=p>,</span>
                <span class=p>(</span>
                    <span class=s1>&#39;After filtering, the query has returned only&#39;</span>
                    <span class=sa>f</span><span class=s1>&#39; </span><span class=si>{</span><span class=n>sources_query_len</span><span class=si>}</span><span class=s1> sources. A minimum of </span><span class=si>{</span><span class=n>min_sources</span><span class=si>}</span><span class=s1>&#39;</span>
                    <span class=s1>&#39; sources must be used to produce the plot.&#39;</span>
                <span class=p>)</span>
            <span class=p>)</span>

            <span class=n>plot_ok</span> <span class=o>=</span> <span class=mi>0</span>

        <span class=k>else</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>new_sources_query_len</span> <span class=o>&gt;</span> <span class=n>settings</span><span class=o>.</span><span class=n>ETA_V_DATASHADER_THRESHOLD</span><span class=p>:</span>
                <span class=n>messages</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
                    <span class=n>request</span><span class=p>,</span>
                    <span class=p>(</span>
                        <span class=s2>&quot;Sources outside of the selected sigma area&quot;</span>
                        <span class=s2>&quot; are displayed as a non-interactive averaged&quot;</span>
                        <span class=s2>&quot; distribution.&quot;</span>
                    <span class=p>)</span>
                <span class=p>)</span>

            <span class=n>plot_ok</span> <span class=o>=</span> <span class=mi>1</span>

    <span class=n>context</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;plot_ok&#39;</span><span class=p>:</span> <span class=n>plot_ok</span><span class=p>,</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;sources_etav_plot.html&#39;</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=vast_pipeline.views.SourceEtaVPlotUpdate class="doc doc-heading"> <code class="highlight language-python"><span class=n>SourceEtaVPlotUpdate</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>pk</span><span class=p>)</span></code> <a href=#vast_pipeline.views.SourceEtaVPlotUpdate class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>The view to perform the update on the eta-V plot page.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django REST Framework request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>pk</code></td> <td> <code>int</code> </td> <td><p>Source object primary key. Defaults to None.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="django.http.Http404">Http404</span></code> </td> <td><p>if a Source with the given <code>pk</code> cannot be found.</p></td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="rest_framework.response.Response">Response</span></code> </td> <td><p>The response for the update page.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1658</span>
<span class=normal>1659</span>
<span class=normal>1660</span>
<span class=normal>1661</span>
<span class=normal>1662</span>
<span class=normal>1663</span>
<span class=normal>1664</span>
<span class=normal>1665</span>
<span class=normal>1666</span>
<span class=normal>1667</span>
<span class=normal>1668</span>
<span class=normal>1669</span>
<span class=normal>1670</span>
<span class=normal>1671</span>
<span class=normal>1672</span>
<span class=normal>1673</span>
<span class=normal>1674</span>
<span class=normal>1675</span>
<span class=normal>1676</span>
<span class=normal>1677</span>
<span class=normal>1678</span>
<span class=normal>1679</span>
<span class=normal>1680</span>
<span class=normal>1681</span>
<span class=normal>1682</span>
<span class=normal>1683</span>
<span class=normal>1684</span>
<span class=normal>1685</span>
<span class=normal>1686</span>
<span class=normal>1687</span>
<span class=normal>1688</span>
<span class=normal>1689</span>
<span class=normal>1690</span>
<span class=normal>1691</span>
<span class=normal>1692</span>
<span class=normal>1693</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=nd>@login_required</span>
<span class=k>def</span> <span class=nf>SourceEtaVPlotUpdate</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>pk</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Response</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;The view to perform the update on the eta-V plot page.</span>

<span class=sd>    Args:</span>
<span class=sd>        request (Request): Django REST Framework request object.</span>
<span class=sd>        pk (int, optional): Source object primary key. Defaults to None.</span>

<span class=sd>    Raises:</span>
<span class=sd>        Http404: if a Source with the given `pk` cannot be found.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The response for the update page.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>source</span> <span class=o>=</span> <span class=n>Source</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>values</span><span class=p>()</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>pk</span><span class=o>=</span><span class=n>pk</span><span class=p>)</span>
    <span class=k>except</span> <span class=n>Source</span><span class=o>.</span><span class=n>DoesNotExist</span><span class=p>:</span>
        <span class=k>raise</span> <span class=n>Http404</span>

    <span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_ra_hms&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>deg2hms</span><span class=p>(</span><span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_ra&#39;</span><span class=p>],</span> <span class=n>hms_format</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_dec_dms&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>deg2dms</span><span class=p>(</span><span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_dec&#39;</span><span class=p>],</span> <span class=n>dms_format</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_l&#39;</span><span class=p>],</span> <span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_b&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>equ2gal</span><span class=p>(</span><span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_ra&#39;</span><span class=p>],</span> <span class=n>source</span><span class=p>[</span><span class=s1>&#39;wavg_dec&#39;</span><span class=p>])</span>

    <span class=n>context</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;source&#39;</span><span class=p>:</span> <span class=n>source</span><span class=p>,</span>
        <span class=s1>&#39;sourcefav&#39;</span><span class=p>:</span> <span class=p>(</span>
            <span class=n>SourceFav</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
                <span class=n>user__id</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
                <span class=n>source__id</span><span class=o>=</span><span class=n>source</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span>
            <span class=p>)</span>
            <span class=o>.</span><span class=n>exists</span><span class=p>()</span>
        <span class=p>),</span>
        <span class=s1>&#39;datatables&#39;</span><span class=p>:</span> <span class=p>[]</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=n>render</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=s1>&#39;sources_etav_plot_update.html&#39;</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>
</code></pre></div> </td></tr></table> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=vast_pipeline.views._process_comment_form_get_comments class="doc doc-heading"> <code class="highlight language-python"><span class=n>_process_comment_form_get_comments</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>instance</span><span class=p>)</span></code> <a href=#vast_pipeline.views._process_comment_form_get_comments class=headerlink title="Permanent link">&para;</a></h2> <div class="doc doc-contents "> <p>Process the comment form and return the form and comment objects. If the <code>request</code> method was POST, create a <code>Comment</code> object attached to <code>instance</code>.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>request</code></td> <td> <code><span title="rest_framework.request.Request">Request</span></code> </td> <td><p>Django HTTP request object.</p></td> <td> <em>required</em> </td> </tr> <tr> <td><code>instance</code></td> <td> <code><a title="vast_pipeline.models.CommentableModel" href="../models/#vast_pipeline.models.CommentableModel">CommentableModel</a></code> </td> <td><p>Django object that is a subclass of <code>CommentableModel</code>. This is the object the comment will be attached to.</p></td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><a title="vast_pipeline.forms.CommentForm" href="../forms/#vast_pipeline.forms.CommentForm">CommentForm</a></code> </td> <td><p>A new, unbound <code>CommentForm</code> instance.</p></td> </tr> <tr> <td> <code>&#39;QuerySet[Comment]&#39;</code> </td> <td><p>The <code>QuerySet</code> of <code>Comment</code> objects attached to <code>instance</code>.</p></td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>vast_pipeline/views.py</code></summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>_process_comment_form_get_comments</span><span class=p>(</span>
    <span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>instance</span><span class=p>:</span> <span class=n>CommentableModel</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>CommentForm</span><span class=p>,</span> <span class=s2>&quot;QuerySet[Comment]&quot;</span><span class=p>]:</span>
    <span class=sd>&quot;&quot;&quot;Process the comment form and return the form and comment objects.</span>
<span class=sd>    If the `request` method was POST, create a `Comment` object attached to</span>
<span class=sd>    `instance`.</span>

<span class=sd>    Args:</span>
<span class=sd>        request: Django HTTP request object.</span>
<span class=sd>        instance: Django object that is a subclass of `CommentableModel`.</span>
<span class=sd>            This is the object the comment will be attached to.</span>

<span class=sd>    Returns:</span>
<span class=sd>        A new, unbound `CommentForm` instance.</span>
<span class=sd>        The `QuerySet` of `Comment` objects attached to `instance`.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&quot;POST&quot;</span><span class=p>:</span>
        <span class=n>comment_form</span> <span class=o>=</span> <span class=n>CommentForm</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>POST</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>comment_form</span><span class=o>.</span><span class=n>is_valid</span><span class=p>():</span>
            <span class=n>comment</span> <span class=o>=</span> <span class=n>comment_form</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>commit</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
            <span class=n>comment</span><span class=o>.</span><span class=n>author</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span>
            <span class=n>comment</span><span class=o>.</span><span class=n>content_object</span> <span class=o>=</span> <span class=n>instance</span>
            <span class=n>comment</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
    <span class=n>comment_form</span> <span class=o>=</span> <span class=n>CommentForm</span><span class=p>()</span>

    <span class=n>comment_target_type</span> <span class=o>=</span> <span class=n>ContentType</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>get_for_model</span><span class=p>(</span><span class=n>instance</span><span class=p>)</span>
    <span class=n>comments</span> <span class=o>=</span> <span class=n>Comment</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
        <span class=n>content_type__pk</span><span class=o>=</span><span class=n>comment_target_type</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>object_id</span><span class=o>=</span><span class=n>instance</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
    <span class=p>)</span><span class=o>.</span><span class=n>order_by</span><span class=p>(</span><span class=s2>&quot;datetime&quot;</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>comment_form</span><span class=p>,</span> <span class=n>comments</span>
</code></pre></div> </td></tr></table> </details> </div> </div> </div> </div> </div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 23, 2022</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 23, 2022</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../urls/ class="md-footer__link md-footer__link--prev" aria-label="Previous: urls.py" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> urls.py </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - 2025 Vast Development Team, University of Sydney - all right reserved </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/askap-vast/vast-pipeline target=_blank rel=noopener title="vast-pipeline source on GitHub" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://vast-survey.org target=_blank rel=noopener title=vast-survey.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.1-20.4-4.2-41.8-4.2-64 0-22.2 2.1-43.6 4.2-64h185.4c2.1 20.4 3.3 41.8 3.3 64zm151.9-64c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42.9 3.2-64 0-22-1.1-43.4-3.2-64h123.1zm-10.5-32H376.7c-10-63.86-29.8-117.38-55.3-151.558C399.8 29.09 463.4 85.94 493.4 160zm-149.1 0H167.7c6.1-36.4 15.5-68.62 27-94.65 10.5-23.61 22.2-40.74 33.5-51.54C239.4 3.178 248.7 0 256 0c7.3 0 16.6 3.178 27.8 13.81 11.3 10.8 23 27.93 33.5 51.54 11.5 26.03 20.9 58.25 27 94.65zm-325.69 0C48.59 85.94 112.2 29.09 190.6 8.442 165.1 42.62 145.3 96.14 135.3 160H18.61zm112.59 32c-2.1 20.6-4.1 42-4.1 64 0 21.1 2 43.4 4.1 64H8.065C2.8 299.5 0 278.1 0 256s2.8-43.5 8.065-64H131.2zm63.5 254.6c-11.5-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.7-22.2 40.8-33.5 51.6-11.2 10.6-20.5 13.8-28.7 13.8-6.4 0-15.7-3.2-26.9-13.8-11.3-10.8-23-27.9-33.5-51.6zm-4.1 57C112.2 482.9 48.59 426.1 18.61 352H135.3c10 63.9 29.8 117.4 55.3 151.6zm130.8 0c25.5-34.2 45.3-87.7 55.3-151.6h116.7c-30 74.1-93.6 130.9-172 151.6z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js", "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.8aa65030.min.js></script> <script src=../../theme/js/extra.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>