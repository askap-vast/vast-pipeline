

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pipeline Configuration &mdash; Vast Pipeline 99.99.99dev documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Vast Pipeline
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing.html">Developing Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">Change Log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vast Pipeline</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Pipeline Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/extra-docs/configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pipeline-configuration">
<h1>Pipeline Configuration<a class="headerlink" href="#pipeline-configuration" title="Permalink to this headline">¶</a></h1>
<p>The following instructions, will get you started in setting up the database and pipeline configuration</p>
<ol class="arabic simple">
<li><p>Copy the setting configuration file template, and fill it with your settings (see <a class="reference external" href="https://github.com/askap-vast/vast-pipeline/blob/master/webinterface/.env.template">defaults</a>.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp webinterface/.env.template webinterface/.env
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Choose a database name and user with password (e.g. database name: <code class="docutils literal notranslate"><span class="pre">vastdb</span></code>; user: <code class="docutils literal notranslate"><span class="pre">vast</span></code>, psw: <code class="docutils literal notranslate"><span class="pre">vastpsw</span></code>), and add the connection details in <code class="docutils literal notranslate"><span class="pre">.env</span></code> (for URL syntax see <a class="reference external" href="https://django-environ.readthedocs.io/en/latest/#tips">this link</a>)</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span>DATABASE_URL=psql://FILLMYUSER:FILLMYPASSWORD@FILLMYHOST:FILLMYPORT/FILLMYDBNAME
</pre></div>
</div>
<p>NOTE: the connection details (host and port) are the same that you setup in [<cite>INSTALL.md</cite>](./INSTALL.md). The database/user names must not contain any spaces or dashes, so use the underscore if you want, e.g. <cite>this_is_my_db_name</cite>.</p>
<ol class="arabic simple" start="3">
<li><p>Create the database user and database name, by running:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./init-tools/init-db.sh localhost <span class="m">5432</span> postgres postgres vast vastpsw vastdb
</pre></div>
</div>
<p>For help on the command run it without arguments</p>
<div class="highlight-language notranslate"><div class="highlight"><pre><span></span>$ ./init-tools/init-db.sh
Usage: init-db.sh HOST PORT ADMINUSER ADMINPSW USER USERPSW DBNAME
Eg:    init-db.sh localhost 5432 postgres postgres vast vastpsw vastdb

Help: This will create a postgresql user &#39;vast&#39; with login password &#39;vastpsw&#39;
     and a database &#39;vastdb&#39; and grant to &#39;vast&#39; user all the privileges to &#39;vastdb&#39;
</pre></div>
</div>
<p>If everything went well the output is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>connecting to PostgreSQL on <span class="s1">&#39;localhost:5433&#39;</span> as admin <span class="s1">&#39;postgres&#39;</span>
creating user <span class="s1">&#39;vast&#39;</span> with login password <span class="s1">&#39;vastpsw&#39;</span> and give it createdb privileges
CREATE ROLE
************************************
creating db <span class="s1">&#39;vastdb&#39;</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Create the database tables. Remember first to activate the Python environment as described in [<cite>INSTALL.md</cite>](./INSTALL.md).</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>pipeline_env<span class="o">)</span>$ ./manage.py migrate
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Create the directories listed at the bottom of <code class="docutils literal notranslate"><span class="pre">settings.py</span></code> and update the details on your setting configuration file <code class="docutils literal notranslate"><span class="pre">.env</span></code> (single name, e.g. <code class="docutils literal notranslate"><span class="pre">pipeline-runs</span></code> means path relative to <code class="docutils literal notranslate"><span class="pre">BASE_DIR</span></code>, so the main folder where you cloned the repo).</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># reference surveys default folder</span>
<span class="n">PIPELINE_WORKING_DIR</span> <span class="o">=</span> <span class="n">env</span><span class="p">(</span><span class="s1">&#39;PIPELINE_WORKING_DIR&#39;</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;pipeline-runs&#39;</span><span class="p">))</span>

<span class="c1"># reference surveys default folder</span>
<span class="n">SURVEYS_WORKING_DIR</span> <span class="o">=</span> <span class="n">env</span><span class="p">(</span><span class="s1">&#39;SURVEYS_WORKING_DIR&#39;</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;reference-surveys&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>The defaults values of the folders are pre-filled in your <a class="reference external" href="https://github.com/askap-vast/vast-pipeline/blob/master/webinterface/.env.template">.env</a> file, and even if that variables are not present in such file, the settings assumed the default values, which are relative to the main repo folder. So create the folders with (Note: make sure you change BASE_DIR to <code class="docutils literal notranslate"><span class="pre">vast-pipeline</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> BASE_DIR <span class="o">&amp;&amp;</span> mkdir pipeline-runs <span class="o">&amp;&amp;</span> mkdir reference-surveys
</pre></div>
</div>
<p>After creating the folders with the defaults values your directory tree should look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>├── CHANGELOG.rst
├── CODE_OF_CONDUCT.rst
├── CONTRIBUTING.rst
├── gulpfile.js
├── init-tools
├── INSTALL.rst
├── LICENSE.txt
├── manage.py
├── node_modules
├── package.json
├── package-lock.json
├── README.rst
├── requirements
├── static
├── templates
├── pipeline-runs
├── vast_pipeline
└── webinterface
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The VAST Development Team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>